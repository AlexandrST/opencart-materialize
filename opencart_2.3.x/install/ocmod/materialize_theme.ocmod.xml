<?xml version="1.0" encoding="utf-8"?>
<modification>
	<name><![CDATA[<font color="#263238"><b>Materialize Theme</b></font>]]></name>
	<code>materialize-theme</code>
	<version>0.76.1</version>
	<author><![CDATA[<font color="#263238"><b>Trydalcoholic</b></font>]]></author>
	<link>https://github.com/trydalcoholic</link>
	<!-- Callback -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$data['name'] = $this->config->get('config_name');]]></search>
			<add position="after"><![CDATA[
			$data['callback'] = $this->load->controller('extension/module/callback', $data);
			]]></add>
		</operation>
	</file>
	<!-- Blog resize image -->
	<file path="catalog/model/tool/image.php">
		<operation error="log">
			<search><![CDATA[public function resize($filename, $width, $height) {]]></search>
			<add position="before"><![CDATA[
			public function resizeBlog($filename, $width, $height, $type = '') {
				if (!is_file(DIR_IMAGE . $filename) || substr(str_replace('\\', '/', realpath(DIR_IMAGE . $filename)), 0, strlen(DIR_IMAGE)) != DIR_IMAGE) {
					return;
				}

				$extension = pathinfo($filename, PATHINFO_EXTENSION);

				$image_old = $filename;

				$image_new = 'cache/' . utf8_substr($filename, 0, utf8_strrpos($filename, '.')) . '-' . (int)$width . 'x' . (int)$height . $type . '.' . $extension;

				if (!is_file(DIR_IMAGE . $image_new) || (filectime(DIR_IMAGE . $image_old) > filectime(DIR_IMAGE . $image_new))) {
					list($width_orig, $height_orig, $image_type) = getimagesize(DIR_IMAGE . $image_old);

					if (!in_array($image_type, array(IMAGETYPE_PNG, IMAGETYPE_JPEG, IMAGETYPE_GIF))) {
						return DIR_IMAGE . $image_old;
					}

					$path = '';

					$directories = explode('/', dirname($image_new));

					foreach ($directories as $directory) {
						$path = $path . '/' . $directory;

						if (!is_dir(DIR_IMAGE . $path)) {
							@mkdir(DIR_IMAGE . $path, 0777);
						}
					}

					if ($width_orig != $width || $height_orig != $height) {
						$image = new Image(DIR_IMAGE . $image_old);

					$image->resizeBlog($width, $height, $type);

						$image->save(DIR_IMAGE . $image_new);
					} else {
						copy(DIR_IMAGE . $image_old, DIR_IMAGE . $image_new);
					}
				}

				$image_new = str_replace(' ', '%20', $image_new);

				if ($this->request->server['HTTPS']) {
					return $this->config->get('config_ssl') . 'image/' . $image_new;
				} else {
					return $this->config->get('config_url') . 'image/' . $image_new;
				}
			}
			]]></add>
		</operation>
	</file>
	<file path="system/library/image.php">
		<operation error="log">
			<search><![CDATA[public function watermark($watermark, $position = 'bottomright') {]]></search>
			<add position="before"><![CDATA[
			public function resizeBlog($width = 0, $height = 0, $default = '') {
				if (!$this->width || !$this->height) {
					return;
				}

				$xpos = 0;
				$ypos = 0;
				$scale = 1;

				$scale_w = $width / $this->width;
				$scale_h = $height / $this->height;
				
				$scale = $scale_w;

				if ($scale == 1 && $scale_h == $scale_w && $this->mime != 'image/png') {
					return;
				}

				$new_width = (int)($this->width * $scale);
				$new_height = (int)($this->height * $scale);
				$xpos = 0;
				$ypos = 0;

				$image_old = $this->image;
				$this->image = imagecreatetruecolor($new_width, $new_height);

				if (isset($this->mime) && $this->mime == 'image/png') {
					imagealphablending($this->image, false);
					imagesavealpha($this->image, true);
					$background = imagecolorallocatealpha($this->image, 255, 255, 255, 127);
					imagecolortransparent($this->image, $background);
				} else {
					$background = imagecolorallocate($this->image, 255, 255, 255);
				}

				imagefilledrectangle($this->image, 0, 0, $new_width, $new_height, $background);

				imagecopyresampled($this->image, $image_old, $xpos, $ypos, 0, 0, $new_width, $new_height, $this->width, $this->height);
				imagedestroy($image_old);

				$this->width  = $new_width;
				$this->height = $new_height;
			}
			]]></add>
		</operation>
	</file>
	<!-- Crop image -->
	<file path="catalog/model/tool/image.php">
		<operation error="log">
			<search><![CDATA[public function resize($filename, $width, $height) {]]></search>
			<add position="replace"><![CDATA[
			public function resize($filename, $width, $height, $type = '') {
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$image_new = 'cache/' . utf8_substr($filename, 0, utf8_strrpos($filename, '.')) . '-' . (int)$width . 'x' . (int)$height . '.' . $extension;]]></search>
			<add position="replace"><![CDATA[
			$image_new = 'cache/' . utf8_substr($filename, 0, utf8_strrpos($filename, '.')) . '-' . (int)$width . 'x' . (int)$height . $type . '.' . $extension;
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$image->resize($width, $height);]]></search>
			<add position="replace"><![CDATA[
			$image->resize($width, $height, $type);
			]]></add>
		</operation>
	</file>
	<file path="system/library/image.php">
		<operation error="log">
			<search><![CDATA[} elseif ($default == 'h') {]]></search>
			<add position="after" offset="1"><![CDATA[
			} elseif ($default == 'crop') {
			if ($width/$height > $this->width/$this->height) {
				$scale = $scale_w;
			} elseif ($width/$height < $this->width/$this->height) {
				$scale = $scale_h;
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[private function html2rgb($color) {]]></search>
			<add position="before"><![CDATA[
			private function imagecopymerge_alpha($dst_im, $src_im, $dst_x, $dst_y, $src_x, $src_y, $src_w, $src_h, $pct) {
				$w = imagesx($src_im);
				$h = imagesy($src_im);

				$cut = imagecreatetruecolor($src_w, $src_h);

				imagecopy($cut, $dst_im, 0, 0, $dst_x, $dst_y, $src_w, $src_h);

				imagecopy($cut, $src_im, 0, 0, $src_x, $src_y, $src_w, $src_h);
				imagecopymerge($dst_im, $cut, $dst_x, $dst_y, $src_x, $src_y, $src_w, $src_h, $pct);
			}
			]]></add>
		</operation>
	</file>
	<!-- Blog -->
	<file path="admin/controller/common/column_left.php">
		<operation error="log">
			<search><![CDATA[if ($this->user->hasPermission('access', 'catalog/information')) {]]></search>
			<add position="before"><![CDATA[
			$blog = array();

			if ($this->user->hasPermission('access', 'blog/category')) {
				$blog[] = array(
					'name'		=> $this->language->get('text_blog_category'),
					'href'		=> $this->url->link('blog/category', 'token=' . $this->session->data['token'], true),
					'children'	=> array()
				);
			}

			if ($this->user->hasPermission('access', 'blog/post')) {
				$blog[] = array(
					'name'		=> $this->language->get('text_blog_post'),
					'href'		=> $this->url->link('blog/post', 'token=' . $this->session->data['token'], true),
					'children'	=> array()
				);
			}

			if ($this->user->hasPermission('access', 'blog/author')) {
				$blog[] = array(
					'name'		=> $this->language->get('text_blog_author'),
					'href'		=> $this->url->link('blog/author', 'token=' . $this->session->data['token'], true),
					'children'	=> array()
				);
			}

			if ($this->user->hasPermission('access', 'blog/comment')) {
				$blog[] = array(
					'name'		=> $this->language->get('text_blog_comment'),
					'href'		=> $this->url->link('blog/comment', 'token=' . $this->session->data['token'], true),
					'children'	=> array()
				);
			}

			if ($blog) {
				$catalog[] = array(
					'name'		=> $this->language->get('text_blog'),
					'href'		=> '',
					'children'	=> $blog
				);
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/startup/seo_pro.php">
		<operation error="log">
			<search><![CDATA[if ($url[0] == 'category_id') {]]></search>
			<add position="before"><![CDATA[
			if ($url[0] == 'blog_category_id') {
				if (!isset($this->request->get['blog_path'])) {
					$this->request->get['blog_path'] = $url[1];
				} else {
					$this->request->get['blog_path'] .= '_' . $url[1];
				}
			} else
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[if (isset($this->request->get['product_id'])) {]]></search>
			<add position="before"><![CDATA[
			if (isset($this->request->get['post_id'])) {
				$this->request->get['route'] = 'blog/post';
				if (!isset($this->request->get['blog_path'])) {
					$path = $this->getPathByBlogPost($this->request->get['post_id']);
					if ($path) $this->request->get['blog_path'] = $path;
				}
			} elseif (isset($this->request->get['blog_path'])) {
				$this->request->get['route'] = 'blog/category';
			} else
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->request->get['route'] = 'product/manufacturer/info';]]></search>
			<add position="after"><![CDATA[
			} elseif (isset($this->request->get['author_id'])) {
				$this->request->get['route'] = 'blog/author/info';
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[case 'product/product':]]></search>
			<add position="before"><![CDATA[
			case 'blog/post':
				if (isset($data['post_id'])) {
					$tmp = $data;
					$data = array();
					if ($this->config->get('config_seo_url_include_path')) {
						$data['blog_path'] = $this->getPathByBlogPost($tmp['post_id']);
						if (!$data['blog_path']) return $link;
					}
					$data['post_id'] = $tmp['post_id'];
				}
				break;

			case 'blog/category':
				if (isset($data['blog_path'])) {
					$category = explode('_', $data['blog_path']);
					$category = end($category);
					$data['blog_path'] = $this->getPathByBlogCategory($category);
					if (!$data['blog_path']) return $link;
				}
				break;
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[case 'product_id':]]></search>
			<add position="before"><![CDATA[
			case 'blog_path':
				$categories = explode('_', $value);
				foreach($categories as $category) {
					$queries[] = 'blog_category_id=' . $category;
				}
				unset($data[$key]);
				break;

			case 'post_id':
			case 'blog_category_id':
			case 'author_id':
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[private function getPathByProduct($product_id) {]]></search>
			<add position="before"><![CDATA[
			private function getPathByBlogPost($post_id) {
				$post_id = (int)$post_id;
				if ($post_id < 1) return false;

				static $path = null;
				if (!isset($path)) {
					$path = $this->cache->get('blog.post.seopath');
					if (!isset($path)) $path = array();
				}

				if (!isset($path[$post_id])) {
					$query = $this->db->query("SELECT category_id FROM " . DB_PREFIX . "post_to_category WHERE post_id = '" . $post_id . "' ORDER BY main_category DESC LIMIT 1");

					$path[$post_id] = $this->getPathByBlogCategory($query->num_rows ? (int)$query->row['category_id'] : 0);

					$this->cache->set('blog.post.seopath', $path);
				}

				return $path[$post_id];
			}

			private function getPathByBlogCategory($category_id) {
				$category_id = (int)$category_id;
				if ($category_id < 1) return false;

				static $path = null;
				if (!isset($path)) {
					$path = $this->cache->get('blog.category.seopath');
					if (!isset($path)) $path = array();
				}

				if (!isset($path[$category_id])) {
					$max_level = 10;

					$sql = "SELECT CONCAT_WS('_'";
					for ($i = $max_level-1; $i >= 0; --$i) {
						$sql .= ",t$i.category_id";
					}
					$sql .= ") AS path FROM " . DB_PREFIX . "blog_category t0";
					for ($i = 1; $i < $max_level; ++$i) {
						$sql .= " LEFT JOIN " . DB_PREFIX . "blog_category t$i ON (t$i.category_id = t" . ($i-1) . ".parent_id)";
					}
					$sql .= " WHERE t0.category_id = '" . $category_id . "'";

					$query = $this->db->query($sql);

					$path[$category_id] = $query->num_rows ? $query->row['path'] : false;

					$this->cache->set('blog.category.seopath', $path);
				}

				return $path[$category_id];
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/startup/seo_url.php">
		<operation error="log">
			<search><![CDATA[if ($url[0] == 'category_id') {]]></search>
			<add position="before"><![CDATA[
			if ($url[0] == 'post_id') {
				$this->request->get['post_id'] = $url[1];
			}

			if ($url[0] == 'author_id') {
				$this->request->get['author_id'] = $url[1];
			}

			if ($url[0] == 'blog_category_id') {
				if (!isset($this->request->get['blog_path'])) {
					$this->request->get['blog_path'] = $url[1];
				} else {
					$this->request->get['blog_path'] .= '_' . $url[1];
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[if ($query->row['query'] && $url[0] != 'information_id' && $url[0] != 'manufacturer_id' && $url[0] != 'category_id' && $url[0] != 'product_id') {]]></search>
			<add position="replace" trim="true"><![CDATA[if ($query->row['query'] && $url[0] != 'information_id' && $url[0] != 'manufacturer_id' && $url[0] != 'category_id' && $url[0] != 'product_id' && $url[0] != 'blog_category_id' && $url[0] != 'author_id' && $url[0] != 'post_id') {]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[} elseif (isset($this->request->get['path'])) {]]></search>
			<add position="before"><![CDATA[
			} elseif (isset($this->request->get['post_id'])) {
				$this->request->get['route'] = 'blog/post';
			} elseif (isset($this->request->get['blog_path'])) {
				$this->request->get['route'] = 'blog/category';
			} elseif (isset($this->request->get['author_id'])) {
				$this->request->get['route'] = 'blog/author/info';
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[if (($data['route'] == 'product/product' && $key == 'product_id') || (($data['route'] == 'product/manufacturer/info' || $data['route'] == 'product/product') && $key == 'manufacturer_id') || ($data['route'] == 'information/information' && $key == 'information_id')) {]]></search>
			<add position="replace" trim="true"><![CDATA[
			if (($data['route'] == 'product/product' && $key == 'product_id') || ($data['route'] == 'blog/post' && $key == 'post_id') || (($data['route'] == 'product/manufacturer/info' || $data['route'] == 'product/product') && $key == 'manufacturer_id') || (($data['route'] == 'blog/author/info' || $data['route'] == 'blog/post') && $key == 'author_id') || ($data['route'] == 'information/information' && $key == 'information_id')) {
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[} elseif ($key == 'path') {]]></search>
			<add position="before"><![CDATA[
			} elseif ($key == 'blog_path') {
				$categories = explode('_', $value);

				foreach ($categories as $category) {
					$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = 'blog_category_id=" . (int)$category . "'");

					if ($query->num_rows && $query->row['keyword']) {
						$url .= '/' . $query->row['keyword'];
					} else {
						$url = '';

						break;
					}
				}

				unset($data[$key]);
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/information/sitemap.php">
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/product');]]></search>
			<add position="after"><![CDATA[
			$this->load->model('blog/category');
			$this->load->model('blog/post');

			$data['blog_categories'] = array();

			$categories_1 = $this->model_blog_category->getCategories(0);

			foreach ($categories_1 as $category_1) {
				$level_2_data = array();

				$categories_2 = $this->model_blog_category->getCategories($category_1['category_id']);

				foreach ($categories_2 as $category_2) {
					$level_3_data = array();

					$categories_3 = $this->model_blog_category->getCategories($category_2['category_id']);

					foreach ($categories_3 as $category_3) {
						$level_3_data[] = array(
							'name'	=> $category_3['name'],
							'href'	=> $this->url->link('blog/category', 'path=' . $category_1['category_id'] . '_' . $category_2['category_id'] . '_' . $category_3['category_id'])
						);
					}

					$level_2_data[] = array(
						'name'		=> $category_2['name'],
						'children'	=> $level_3_data,
						'href'		=> $this->url->link('blog/category', 'path=' . $category_1['category_id'] . '_' . $category_2['category_id'])
					);
				}

				$data['blog_categories'][] = array(
					'name'		=> $category_1['name'],
					'children'	=> $level_2_data,
					'href'		=> $this->url->link('blog/category', 'path=' . $category_1['category_id'])
				);
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/feed/google_sitemap.php">
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/product');]]></search>
			<add position="after"><![CDATA[
			$this->load->model('blog/post');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$products = $this->model_catalog_product->getProducts();]]></search>
			<add position="after"><![CDATA[
			$posts = $this->model_blog_post->getPosts();
			]]></add>
		</operation>
		<operation error="log">
			<search index="0"><![CDATA[foreach ($products as $product) {]]></search>
			<add position="before"><![CDATA[
			foreach ($posts as $post) {
				if ($post['image']) {
					$output .= '<url>';
					$output .= '<loc>' . $this->url->link('blog/post', 'post_id=' . $post['post_id']) . '</loc>';
					$output .= '<changefreq>weekly</changefreq>';
					$output .= '<lastmod>' . date('Y-m-d\TH:i:sP', strtotime($post['date_modified'])) . '</lastmod>';
					$output .= '<priority>1.0</priority>';
					$output .= '<image:image>';
					$output .= '<image:loc>' . $this->model_tool_image->resize($post['image'], $this->config->get($this->config->get('config_theme') . '_image_popup_width'), $this->config->get($this->config->get('config_theme') . '_image_popup_height'), 'crop') . '</image:loc>';
					$output .= '<image:caption>' . $post['name'] . '</image:caption>';
					$output .= '<image:title>' . $post['name'] . '</image:title>';
					$output .= '</image:image>';
					$output .= '</url>';
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/category');]]></search>
			<add position="after"><![CDATA[
			$this->load->model('blog/category');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$output .= $this->getCategories(0);]]></search>
			<add position="after"><![CDATA[
			$output .= $this->getBlogCategories(0);
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[protected function getCategories($parent_id, $current_path = '') {]]></search>
			<add position="before"><![CDATA[
			protected function getBlogCategories($parent_id, $current_path = '') {
				$output = '';

				$results = $this->model_blog_category->getCategories($parent_id);

				foreach ($results as $result) {
					if (!$current_path) {
						$new_path = $result['category_id'];
					} else {
						$new_path = $current_path . '_' . $result['category_id'];
					}

					$output .= '<url>';
					$output .= '<loc>' . $this->url->link('blog/category', 'blog_path=' . $new_path) . '</loc>';
					$output .= '<changefreq>weekly</changefreq>';
					$output .= '<priority>0.7</priority>';
					$output .= '</url>';

					$posts = $this->model_blog_post->getPosts(array('filter_category_id' => $result['category_id']));

					foreach ($posts as $post) {
						$output .= '<url>';
						$output .= '<loc>' . $this->url->link('blog/post', 'blog_path=' . $new_path . '&post_id=' . $post['post_id']) . '</loc>';
						$output .= '<changefreq>weekly</changefreq>';
						$output .= '<priority>1.0</priority>';
						$output .= '</url>';
					}

					$output .= $this->getCategories($result['category_id'], $new_path);
				}

				return $output;
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/manufacturer');]]></search>
			<add position="after"><![CDATA[
			$this->load->model('blog/author');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$manufacturers = $this->model_catalog_manufacturer->getManufacturers();]]></search>
			<add position="after"><![CDATA[
			$authors = $this->model_blog_author->getAuthors();
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[foreach ($manufacturers as $manufacturer) {]]></search>
			<add position="before"><![CDATA[
			foreach ($authors as $author) {
				$output .= '<url>';
				$output .= '<loc>' . $this->url->link('blog/author/info', 'author_id=' . $author['author_id']) . '</loc>';
				$output .= '<changefreq>weekly</changefreq>';
				$output .= '<priority>0.7</priority>';
				$output .= '</url>';

				$posts = $this->model_blog_post->getPosts(array('filter_author_id' => $author['author_id']));

				foreach ($posts as $post) {
					$output .= '<url>';
					$output .= '<loc>' . $this->url->link('blog/post', 'author_id=' . $author['author_id'] . '&post_id=' . $post['post_id']) . '</loc>';
					$output .= '<changefreq>weekly</changefreq>';
					$output .= '<priority>1.0</priority>';
					$output .= '</url>';
				}
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$data['text_all'] = $this->language->get('text_all');]]></search>
			<add position="after"><![CDATA[
			$data['text_blog'] = $this->language->get('text_blog');
			$data['blog'] = $this->url->link('blog/category');
			]]></add>
		</operation>
	</file>
	<!-- Additional Fields -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['images'] = array();]]></search>
			<add position="before"><![CDATA[
			$data['additionalfields'] = array();
			$results = $this->model_catalog_product->getProductfields($this->request->get['product_id']);
			foreach ($results as $result) {
				$data['additionalfields'][] = array(
					'title'	=> $result['title'],
					'text'	=> $result['text'],
				);
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/controller/catalog/product.php">
		<operation error="log">
			<search><![CDATA[if (isset($this->request->post['image'])) {]]></search>
			<add position="before"><![CDATA[
			$data['entry_title_additional']=$this->language->get('entry_title_additional');
			$data['button_additionalfield_add']=$this->language->get('button_additionalfield_add');
			$data['tab_additionalfield']=$this->language->get('tab_additionalfield');

			if (isset($this->request->post['product_additionalfield'])) {
				$data['product_additionalfields'] = $this->request->post['product_additionalfield'];
			} elseif (isset($this->request->get['product_id'])) {
				$data['product_additionalfields'] = $this->model_catalog_product->getProductadditionalfields($this->request->get['product_id']);
			} else {
				$data['product_additionalfields'] = array();
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$product_id = $this->db->getLastId();]]></search>
			<add position="after"><![CDATA[
			if (isset($data['product_additionalfield'])) {
				foreach ($data['product_additionalfield'] as $product_additionalfield) {
					$this->db->query("INSERT INTO " . DB_PREFIX . "product_additionalfield SET product_id = '" . (int)$product_id . "', sort_order = '" . (int)$product_additionalfield['sort_order'] . "', status = '" . (int)$product_additionalfield['status'] . "'");

					$product_additionalfield_id = $this->db->getLastId();

					foreach ($product_additionalfield['product_additionalfield_text'] as $language_id => $product_additionalfield_text) {
						$this->db->query("INSERT INTO " . DB_PREFIX . "product_additionalfield_text SET product_additionalfield_id = '" . (int)$product_additionalfield_id . "', language_id = '" . (int)$language_id . "', product_id = '" . (int)$product_id . "', title = '" . $this->db->escape($product_additionalfield_text['title']) . "', text = '" . $this->db->escape($product_additionalfield_text['text']) . "'");
					}
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[date_modified = NOW() WHERE product_id = '" . (int)$product_id . "'");]]></search>
			<add position="after"><![CDATA[
			$this->db->query("DELETE FROM " . DB_PREFIX . "product_additionalfield WHERE product_id = '" . (int)$product_id . "'");
			$this->db->query("DELETE FROM " . DB_PREFIX . "product_additionalfield_text WHERE product_id = '" . (int)$product_id . "'");
			if (isset($data['product_additionalfield'])) {
				foreach ($data['product_additionalfield'] as $product_additionalfield) {
					$this->db->query("INSERT INTO " . DB_PREFIX . "product_additionalfield SET product_id = '" . (int)$product_id . "', sort_order = '" . (int)$product_additionalfield['sort_order'] . "', status = '" . (int)$product_additionalfield['status'] . "'");

					$product_additionalfield_id = $this->db->getLastId();

					foreach ($product_additionalfield['product_additionalfield_text'] as $language_id => $product_additionalfield_text) {
						$this->db->query("INSERT INTO " . DB_PREFIX . "product_additionalfield_text SET product_additionalfield_id = '" . (int)$product_additionalfield_id . "', language_id = '" . (int)$language_id . "', product_id = '" . (int)$product_id . "', title = '" . $this->db->escape($product_additionalfield_text['title']) . "', text = '" . $this->db->escape($product_additionalfield_text['text']) . "'");
					}
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[public function getProductImages($product_id) {]]></search>
			<add position="before"><![CDATA[
			public function getProductadditionalfields($product_id) {
				$product_additionalfield_data = array();
				$product_additionalfield_query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_additionalfield WHERE product_id = '" . (int)$product_id . "' ORDER BY sort_order ASC");
				foreach ($product_additionalfield_query->rows as $product_additionalfield) {
					$product_additionalfield_text_data = array();
					$product_additionalfield_text_query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_additionalfield_text WHERE product_additionalfield_id = '" . (int)$product_additionalfield['product_additionalfield_id'] . "' AND product_id = '" . (int)$product_id . "'");

					foreach ($product_additionalfield_text_query->rows as $product_additionalfield_text) {
						$product_additionalfield_text_data[$product_additionalfield_text['language_id']] = array(
							'title'	=> $product_additionalfield_text['title'],
							'text'	=> $product_additionalfield_text['text'],
						);
					}

					$product_additionalfield_data[] = array(
						'product_additionalfield_text'	=> $product_additionalfield_text_data,
						'status'						=> $product_additionalfield['status'],
						'sort_order'					=> $product_additionalfield['sort_order']
					);
				}
				return $product_additionalfield_data;
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function getProductImages($product_id) {]]></search>
			<add position="before"><![CDATA[
			public function getProductfields($product_id) {
				$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_additionalfield pc LEFT JOIN " . DB_PREFIX . "product_additionalfield_text pcd ON (pc.product_additionalfield_id = pcd.product_additionalfield_id) WHERE pc.product_id = '" . (int)$product_id . "' AND pcd.language_id = '" . (int)$this->config->get('config_language_id') . "' AND status > 0 ORDER BY sort_order ASC");

				return $query->rows;
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/product_form.tpl">
		<operation error="log">
			<search><![CDATA[<li><a href="#tab-design" data-toggle="tab"><?php echo $tab_design; ?></a></li>]]></search>
			<add position="after"><![CDATA[
			<li><a href="#tab-additionalfieldmain" data-toggle="tab"><?php echo $tab_additionalfield; ?></a></li>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<div class="tab-pane" id="tab-design">]]></search>
			<add position="before"><![CDATA[
			<div class="tab-pane" id="tab-additionalfieldmain">
				<div class="col-sm-2">
					<ul class="nav nav-pills nav-stacked" id="additionalfield">
					<?php $additionalfield_row = 0; ?>
						<?php foreach ($product_additionalfields as $product_additionalfield) { ?>
						<li><a href="#tab-additionalfield<?php echo $additionalfield_row; ?>" data-toggle="tab"><i class="fa fa-minus-circle" onclick="$('a[href=\'#tab-additionalfield<?php echo $additionalfield_row; ?>\']').parent().remove(); $('#tab-additionalfield<?php echo $additionalfield_row; ?>').remove(); $('#additionalfield a:first').tab('show');"></i> <?php echo $tab_additionalfield . ' ' . $additionalfield_row; ?></a></li>
						<?php $additionalfield_row++; ?>
						<?php } ?>
						<li id="additionalfield-add"><a onclick="addadditionalfield();"><i class="fa fa-plus-circle"></i> <?php echo $button_additionalfield_add; ?></a></li>
					</ul>
				</div>
				<div class="col-sm-10">
					<div class="tab-content tab-content2">
						<?php $additionalfield_row = 0; ?>
						<?php foreach ($product_additionalfields as $product_additionalfield) { ?>
						<div class="tab-pane" id="tab-additionalfield<?php echo $additionalfield_row; ?>">
							<ul class="nav nav-tabs" id="clanguage<?php echo $additionalfield_row; ?>">
								<?php foreach ($languages as $language) { ?>
								<li><a href="#tab-additionalfield<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>" data-toggle="tab"><img src="language/<?php echo $language['code']; ?>/<?php echo $language['code']; ?>.png" title="<?php echo $language['name']; ?>" /> <?php echo $language['name']; ?></a></li>
								<?php } ?>
							</ul>
							<div class="tab-content">
								<?php foreach ($languages as $language) { ?>
								<div class="tab-pane" id="tab-additionalfield<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>">
									<div class="form-group">
										<label class="col-sm-2 control-label" for="input-heading<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>"><?php echo $entry_title_additional; ?></label>
										<div class="col-sm-10">
											<input type="text" name="product_additionalfield[<?php echo $additionalfield_row; ?>][product_additionalfield_text][<?php echo $language['language_id']; ?>][title]" value="<?php echo isset($product_additionalfield['product_additionalfield_text'][$language['language_id']]) ? $product_additionalfield['product_additionalfield_text'][$language['language_id']]['title'] : ''; ?>" class="form-control"/>
										</div>
									</div>
									<div class="form-group">
										<label class="col-sm-2 control-label" for="input-text<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>"><?php echo $entry_text; ?></label>
										<div class="col-sm-10">
											<input type="text" name="product_additionalfield[<?php echo $additionalfield_row; ?>][product_additionalfield_text][<?php echo $language['language_id']; ?>][text]" value="<?php echo isset($product_additionalfield['product_additionalfield_text'][$language['language_id']]) ? $product_additionalfield['product_additionalfield_text'][$language['language_id']]['text'] : ''; ?>" id="input-text<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>" class="form-control"/>
										</div>
									</div>
								</div>
								<?php } ?>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-sort_order<?php echo $additionalfield_row; ?>"><?php echo $entry_sort_order; ?></label>
								<div class="col-sm-10">
									<input type="text" name="product_additionalfield[<?php echo $additionalfield_row; ?>][sort_order]" value="<?php echo $product_additionalfield['sort_order']; ?>" placeholder="<?php echo $entry_sort_order; ?>" class="form-control" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-status<?php echo $additionalfield_row; ?>"><?php echo $entry_status; ?></label>
								<div class="col-sm-10">
									<select name="product_additionalfield[<?php echo $additionalfield_row; ?>][status]" id="input-status" class="form-control">
										<?php if ($product_additionalfield['status']) { ?>
										<option value="1" selected="selected"><?php echo $text_enabled; ?></option>
										<option value="0"><?php echo $text_disabled; ?></option>
										<?php } else { ?>
										<option value="1"><?php echo $text_enabled; ?></option>
										<option value="0" selected="selected"><?php echo $text_disabled; ?></option>
										<?php } ?>
									</select>
								</div>
							</div>
						</div>
						<?php $additionalfield_row++; ?>
						<?php } ?>
					</div>
				</div>
			</div>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<?php echo $footer; ?>]]></search>
			<add position="before"><![CDATA[
			<script type="text/javascript"><!--
				<?php $additionalfield_row = 0; ?>
				<?php foreach ($product_additionalfields as $product_additionalfield) { ?>
				<?php foreach ($languages as $language) { ?>
				$('#input-text<?php echo $additionalfield_row; ?>-language<?php echo $language['language_id']; ?>');
				<?php } ?>
				<?php $additionalfield_row++; ?>
				<?php } ?>
			//--></script>
			<script type="text/javascript"><!--
				var additionalfield_row = <?php echo $additionalfield_row; ?>;
				function addadditionalfield() {
					html = '<div id="tab-additionalfield' + additionalfield_row + '" class="tab-pane">';
					html += '	<ul class="nav nav-tabs" id="clanguage' + additionalfield_row + '">';
					<?php foreach ($languages as $language) { ?>
					html += '		<li><a href="#tab-additionalfield' + additionalfield_row + '-language<?php echo $language['language_id']; ?>" data-toggle="tab"><img src="language/<?php echo $language['code']; ?>/<?php echo $language['code']; ?>.png" title="<?php echo $language['name']; ?>" /> <?php echo $language['name']; ?></a></li>';
					<?php } ?>
					html += '	</ul>';
					html += '	<div class="tab-content">';
					<?php foreach ($languages as $language) { ?>
					html += '		<div class="tab-pane" id="tab-additionalfield' + additionalfield_row + '-language<?php echo $language['language_id']; ?>">';
					html += '			<div class="form-group">';
					html += '				<label class="col-sm-2 control-label" for="input-title' + additionalfield_row + '-language<?php echo $language['language_id']; ?>"><?php echo $entry_title_additional; ?></label>';
					html += '				<div class="col-sm-10"><input type="text" name="product_additionalfield[' + additionalfield_row + '][product_additionalfield_text][<?php echo $language['language_id']; ?>][title]" placeholder="<?php echo $entry_title_additional; ?>" id="input-title' + additionalfield_row + '-language<?php echo $language['language_id']; ?>" value="" class="form-control"/></div>';
					html += '			</div>';
					html += '			<div class="form-group">';
					html += '				<label class="col-sm-2 control-label" for="input-text' + additionalfield_row + '-language<?php echo $language['language_id']; ?>"><?php echo $entry_text; ?></label>';
					html += '				<div class="col-sm-10"><input type="text" name="product_additionalfield[' + additionalfield_row + '][product_additionalfield_text][<?php echo $language['language_id']; ?>][text]" value="<?php echo isset($product_additionalfield['product_additionalfield_text'][$language['language_id']]) ? $product_additionalfield['product_additionalfield_text'][$language['language_id']]['text'] : ''; ?>" id="input-text' + additionalfield_row + '-language<?php echo $language['language_id']; ?>" class="form-control"/></div>';
					html += '			</div>';
					html += '		</div>';
					<?php } ?>
					html += '	</div>';
					html += '	<div class="form-group">';
					html += '		<label class="col-sm-2 control-label" for="input-sort_order' + additionalfield_row +'"><?php echo $entry_sort_order; ?></label>';
					html += '		<div class="col-sm-10"><input type="text" name="product_additionalfield[' + additionalfield_row + '][sort_order]" value="" class="form-control" /></div>';
					html += '	</div>';
					html += '	<div class="form-group">';
					html += '		<label class="col-sm-2 control-label" for="input-status' + additionalfield_row +'"><?php echo $entry_status; ?></label>';
					html += '		<div class="col-sm-10"><select name="product_additionalfield[' + additionalfield_row + '][status]" class="form-control"><option value="1"><?php echo $text_enabled; ?></option><option value="0"><?php echo $text_disabled; ?></option></select></div>';
					html += '	</div>';
					html += '</div>';
					$('#tab-additionalfieldmain .tab-content2').append(html);
					<?php foreach ($languages as $language) { ?>
					$('#input-text' + additionalfield_row + '-language<?php echo $language['language_id']; ?>');
				<?php } ?>
				$('#additionalfield a[href=\'#tab-additionalfield' + additionalfield_row + '\']').tab('show');
				$('#clanguage' + additionalfield_row + ' li:first-child a').tab('show');
				$('#additionalfield-add').before('<li><a href="#tab-additionalfield' + additionalfield_row + '" data-toggle="tab"><i class="fa fa-minus-circle" onclick="$(\'a[href=\\\'#tab-additionalfield' + additionalfield_row + '\\\']\').parent().remove(); $(\'#tab-additionalfield' + additionalfield_row + '\').remove(); $(\'#additionalfield li a:first\').tab(\'show\');"></i> <?php echo $tab_additionalfield; ?> ' + additionalfield_row + '</a></li>');
				$('#additionalfield-' + additionalfield_row).trigger('click');
				additionalfield_row++;
				}
			//--></script>
			<script type="text/javascript"><!--
				$('#additionalfield li:first-child a').tab('show');
				<?php $additionalfield_row = 0; ?>
				<?php foreach ($product_additionalfields as $product_additionalfield) { ?>
				$('#clanguage<?php echo $additionalfield_row; ?> li:first-child a').tab('show');
				<?php $additionalfield_row++; ?>
				<?php } ?>
			//--></script>
			]]></add>
		</operation>
	</file>
	<!-- Size Chart -->
	<file path="admin/controller/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$data['entry_recurring'] = $this->language->get('entry_recurring');]]></search>
			<add position="after"><![CDATA[
			$data['entry_size_chart'] = $this->language->get('entry_size_chart');
			]]></add>
		</operation>
	</file>
	<file path="admin/model/catalog/product.php">
		<operation error="skip">
			<search><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "product_description SET product_id = '" . (int)$product_id . "', language_id = '" . (int)$language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', tag = '" . $this->db->escape($value['tag']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
			]]></search>
			<add position="replace" trim="true"><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "product_description SET product_id = '" . (int) $product_id . "', language_id = '" . (int) $language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', size_chart = '" . $this->db->escape($value['size_chart']) . "', tag = '" . $this->db->escape($value['tag']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
			]]></add>
		</operation>
		<operation error="skip">
			<search><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "product_description SET product_id = '" . (int)$product_id . "', language_id = '" . (int)$language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', tag = '" . $this->db->escape($value['tag']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
			]]></search>
			<add position="replace" trim="true"><![CDATA[
			$this->db->query("INSERT INTO " . DB_PREFIX . "product_description SET product_id = '" . (int)$product_id . "', language_id = '" . (int)$language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', size_chart = '" . $this->db->escape($value['size_chart']) . "', tag = '" . $this->db->escape($value['tag']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$product_description_data[$result['language_id']] = array(]]></search>
			<add position="after" trim="true"><![CDATA[
			'size_chart' => $result['size_chart'],
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/product_form.tpl">
		<operation error="skip">
			<search><![CDATA[
			<textarea name="product_description[<?php echo $language['language_id']; ?>][description]" placeholder="<?php echo $entry_description; ?>" id="input-description<?php echo $language['language_id']; ?>" data-lang="<?php echo $lang; ?>" class="form-control summernote"><?php echo isset($product_description[$language['language_id']]) ? $product_description[$language['language_id']]['description'] : ''; ?></textarea>
			]]></search>
			<add position="after"><![CDATA[
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label" for="input-description<?php echo $language['language_id']; ?>"><?php echo $entry_size_chart; ?></label>
				<div class="col-sm-10">
					<textarea name="product_description[<?php echo $language['language_id']; ?>][size_chart]" placeholder="<?php echo $entry_size_chart; ?>" id="input-size_chart<?php echo $language['language_id']; ?>" data-lang="<?php echo $lang; ?>" class="form-control summernote"><?php echo isset($product_description[$language['language_id']]) ? $product_description[$language['language_id']]['size_chart'] : ''; ?></textarea>
			]]></add>
		</operation>
		<operation error="skip">
			<search><![CDATA[
			<textarea name="product_description[<?php echo $language['language_id']; ?>][description]" placeholder="<?php echo $entry_description; ?>" id="input-description<?php echo $language['language_id']; ?>" class="form-control summernote"><?php echo isset($product_description[$language['language_id']]) ? $product_description[$language['language_id']]['description'] : ''; ?></textarea>
			]]></search>
			<add position="after"><![CDATA[
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label" for="input-description<?php echo $language['language_id']; ?>"><?php echo $entry_size_chart; ?></label>
				<div class="col-sm-10">
					<textarea name="product_description[<?php echo $language['language_id']; ?>][size_chart]" placeholder="<?php echo $entry_size_chart; ?>" id="input-size_chart<?php echo $language['language_id']; ?>" class="form-control summernote"><?php echo isset($product_description[$language['language_id']]) ? $product_description[$language['language_id']]['size_chart'] : ''; ?></textarea>
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[if (isset($this->request->get['category_id'])) {]]></search>
			<add position="before"><![CDATA[
			if (isset($this->request->get['size_chart'])) {
				$url .= '&size_chart=' . $this->request->get['size_chart'];
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/review');]]></search>
			<add position="after"><![CDATA[
			$data['text_size_chart'] = $this->language->get('text_size_chart');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['rating'] = (int)$product_info['rating'];]]></search>
			<add position="after"><![CDATA[
			$data['size_chart'] = html_entity_decode($product_info['size_chart'], ENT_QUOTES, 'UTF-8');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['header'] = $this->load->controller('common/header');]]></search>
			<add position="after"><![CDATA[
			$data['sizechart'] = $this->load->controller('extension/module/sizechart');
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA['meta_description' => $query->row['meta_description'],]]></search>
			<add position="after"><![CDATA[
			'size_chart' => $query->row['size_chart'],
			]]></add>
		</operation>
	</file>
	<!-- Integration of the module "SourceCode Compressor" https://www.opencart.com/index.php?route=marketplace/extension/info&extension_id=29699 -->
	<file path="system/library/response.php">
		<operation error="log">
			<search><![CDATA[if ($this->output) {]]></search>
			<add position="after"><![CDATA[
			$this->output = preg_replace("/(\n)+/", "\n", $this->output);
			$this->output = preg_replace("/\r\n+/", "\n", $this->output);
			$this->output = preg_replace("/\n(\t)+/", "\n", $this->output);
			$this->output = preg_replace("/\n(\ )+/", "\n", $this->output);
			$this->output = preg_replace("/\>[^\S ]+/s", '>', $this->output);
			$this->output = preg_replace("/[^\S ]+\</s", '<', $this->output);
			$this->output = preg_replace('/>\s+</', '><', $this->output);
			$this->output = preg_replace("/\>(\n)+</", '><', $this->output);
			$this->output = preg_replace("/\>\r\n</", '><', $this->output);
			$this->output = preg_replace('~>\s*\n\s*<~', '><', $this->output);
			]]></add>
		</operation>
	</file>
	<!-- Checking email -->
	<file path="catalog/controller/information/contact.php">
		<operation error="log">
			<search><![CDATA[$data['text_comment'] = $this->language->get('text_comment');]]></search>
			<add position="before"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/checkout/guest.php">
		<operation error="log">
			<search><![CDATA[$data['text_select'] = $this->language->get('text_select');]]></search>
			<add position="before"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/checkout/login.php">
		<operation error="log">
			<search><![CDATA[$data['text_checkout_account'] = $this->language->get('text_checkout_account');]]></search>
			<add position="before"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/checkout/register.php">
		<operation error="log">
			<search><![CDATA[$data['text_checkout_payment_address'] = $this->language->get('text_checkout_payment_address');]]></search>
			<add position="before"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/affiliate/register.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/affiliate/login.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/affiliate/edit.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/account/register.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/account/login.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/account/edit.php">
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="after"><![CDATA[
			$data['text_email_error'] = $this->language->get('text_email_error');
			$data['text_email_success'] = $this->language->get('text_email_success');
			]]></add>
		</operation>
	</file>
	<!-- SKU on product page -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['points'] = $product_info['points'];]]></search>
			<add position="after"><![CDATA[
			$data['sku'] = $product_info['sku'];
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['text_points'] = $this->language->get('text_points');]]></search>
			<add position="after"><![CDATA[
			$data['text_sku'] = $this->language->get('text_sku');
			]]></add>
		</operation>
	</file>
	<!-- Filter -->
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$sql .= " AND pf.filter_id IN (" . implode(',', $implode) . ")";]]></search>
			<add position="after"><![CDATA[
			$minq=$this->db->query("SELECT id.product_id FROM(SELECT product_id, count(i.product_id) as t, c.filter_group as b FROM (SELECT f.filter_id, f.product_id, p.filter_group_id FROM ". DB_PREFIX ."product_filter f left join ". DB_PREFIX ."filter p ON p.filter_id = f.filter_id where p.filter_id IN (" . implode(',', $implode) . ") GROUP BY product_id , filter_group_id) as i, (select count(distinct filter_group_id) as filter_group from ". DB_PREFIX ."filter_description f_b WHERE f_b.filter_id in (" . implode(',', $implode) . ")) as c GROUP BY product_id HAVING t = b) as id");
			$min = array();
			for ($x = 0; $x < count($minq->rows); $x++){
				foreach($minq->rows[$x] as $value){
					$min[]=$value;
				}
			}
			$imp = implode(',',$min);
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$sql .= " AND p.manufacturer_id = '" . (int)$data['filter_manufacturer_id'] . "'";]]></search>
			<add position="after" offset="1"><![CDATA[
			if(isset($filters)) {
				if(!count($min)) {
					$imp='0000000';
				}
				$sql .= " AND p.product_id IN(".$imp.")";
			}
			]]></add>
		</operation>
	</file>
	<!-- Update price -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[public function getRecurringDescription() {]]></search>
			<add position="before"><![CDATA[
			public function updatePrice() {
				$json = array();

				$this->load->model('catalog/product');

				$product_info = $this->model_catalog_product->getProduct($this->request->get['product_id']);
				$option_price = 0;

				if(isset($this->request->post['option']) && $this->request->post['option']) {
					foreach($this->request->post['option'] as $product_option_id => $value) {
						$result = $this->model_catalog_product->getUpdateOptionsList($this->request->get['product_id'], $product_option_id);
						if($result) {
							if($result['type'] == 'select' || $result['type'] == 'radio') {
								$option_values = $this->model_catalog_product->getUpdateOptionValues($value, $product_option_id);
								if($option_values) {
									if ($option_values['price_prefix'] == '+') {
										$option_price += $option_values['price'];
									} elseif ($option_values['price_prefix'] == '-') {
										$option_price -= $option_values['price'];
									}
								}
							} elseif ($result['type'] == 'checkbox' && is_array($value)) {
								foreach ($value as $product_option_value_id) {
									$option_values = $this->model_catalog_product->getUpdateOptionChcekboxValues($product_option_value_id, $product_option_id);
									if($option_values) {
										if ($option_values['price_prefix'] == '+') {
											$option_price += $option_values['price'];
										} elseif ($option_values['price_prefix'] == '-') {
											$option_price -= $option_values['price'];
										}
									}
								}
							}
						}
					}
				}

				$price = $product_info['price'];
				$new_price_found = 0;

				$discount_amount = $this->model_catalog_product->getDiscountAmountForUpdatePrice($this->request->get['product_id'], $this->request->post['quantity']);

				if ($discount_amount) {
					$price = $discount_amount;
				}

				if ($product_info['special']) {
					$price = $product_info['special'];
					$new_price_found = 1;
				}

				$total_price = $price + $option_price;

				$unit_price = $this->tax->calculate($total_price, $product_info['tax_class_id'], $this->config->get('config_tax'));
				$total = $this->currency->format($unit_price * $this->request->post['quantity'], $this->session->data['currency']);

				$unit_tax = $this->tax->calculate($product_info['price'], $product_info['tax_class_id'], $this->config->get('config_tax'));
				$tax_total = $this->currency->format(((float)$product_info['special'] ? ($product_info['special'] + $option_price) : ($product_info['price'] + $option_price)) * $this->request->post['quantity'], $this->session->data['currency']);

				$json['total_price'] = $total;
				$json['new_price_found'] = $new_price_found;
				$json['tax_price'] = $tax_total;
				$this->response->addHeader('Content-Type: application/json');
				$this->response->setOutput(json_encode($json));
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function getTotalProductSpecials() {]]></search>
			<add position="before"><![CDATA[
			public function getUpdateOptionsList($product_id, $product_option_id) {
				$option_query = $this->db->query("SELECT po.product_option_id, po.option_id, od.name, o.type FROM " . DB_PREFIX . "product_option po LEFT JOIN `" . DB_PREFIX . "option` o ON (po.option_id = o.option_id) LEFT JOIN " . DB_PREFIX . "option_description od ON (o.option_id = od.option_id) WHERE po.product_option_id = '" . (int)$product_option_id . "' AND po.product_id = '" . (int)$product_id . "' AND od.language_id = '" . (int)$this->config->get('config_language_id') . "'");
				if($option_query->num_rows) {
					return $option_query->row;
				} else {
					return '';
				}
			}

			public function getUpdateOptionValues($value, $product_option_id) {
				$option_value_query = $this->db->query("SELECT pov.option_value_id, ovd.name, pov.quantity, pov.subtract, pov.price, pov.price_prefix, pov.points, pov.points_prefix, pov.weight, pov.weight_prefix FROM " . DB_PREFIX . "product_option_value pov LEFT JOIN " . DB_PREFIX . "option_value ov ON (pov.option_value_id = ov.option_value_id) LEFT JOIN " . DB_PREFIX . "option_value_description ovd ON (ov.option_value_id = ovd.option_value_id) WHERE pov.product_option_value_id = '" . (int)$value . "' AND pov.product_option_id = '" . (int)$product_option_id . "' AND ovd.language_id = '" . (int)$this->config->get('config_language_id') . "'");
				if($option_value_query->num_rows) {
					return $option_value_query->row;
				} else {
					return '';
				}
			}

			public function getUpdateOptionChcekboxValues($product_option_value_id, $product_option_id) {
				$option_value_query = $this->db->query("SELECT pov.option_value_id, ovd.name, pov.quantity, pov.subtract, pov.price, pov.price_prefix, pov.points, pov.points_prefix, pov.weight, pov.weight_prefix FROM " . DB_PREFIX . "product_option_value pov LEFT JOIN " . DB_PREFIX . "option_value ov ON (pov.option_value_id = ov.option_value_id) LEFT JOIN " . DB_PREFIX . "option_value_description ovd ON (ov.option_value_id = ovd.option_value_id) WHERE pov.product_option_value_id = '" . (int)$product_option_value_id . "' AND pov.product_option_id = '" . (int)$product_option_id . "' AND ovd.language_id = '" . (int)$this->config->get('config_language_id') . "'");
				if($option_value_query->num_rows) {
					return $option_value_query->row;
				} else {
					return '';
				}
			}

			public function getDiscountAmountForUpdatePrice($product_id, $quantity) {
				$product_discount_query = $this->db->query("SELECT price FROM " . DB_PREFIX . "product_discount WHERE product_id = '" . (int)$product_id . "' AND customer_group_id = '" . (int)$this->config->get('config_customer_group_id') . "' AND quantity <= '" . (int)$quantity . "' AND ((date_start = '0000-00-00' OR date_start < NOW()) AND (date_end = '0000-00-00' OR date_end > NOW())) ORDER BY quantity DESC, priority ASC, price ASC LIMIT 1");
				if($product_discount_query->num_rows) {
					return $product_discount_query->row['price'];
				} else {
					return '';
				}
			}
			]]></add>
		</operation>
	</file>
	<!-- Live search -->
	<file path="catalog/controller/common/search.php">
		<operation error="log">
			<search><![CDATA[public function index() {]]></search>
			<add position="before"><![CDATA[
			public function autocomplete() {
				$json = array();

				if (isset($this->request->get['filter_name']) || isset($this->request->get['filter_model'])) {
					$this->load->model('catalog/product');
					$this->load->model('tool/image');

					if (isset($this->request->get['filter_name'])) {
						$filter_name = $this->request->get['filter_name'];
					} else {
						$filter_name = '';
					}

					if (isset($this->request->get['filter_model'])) {
						$filter_model = $this->request->get['filter_model'];
					} else {
						$filter_model = '';
					}

					if (isset($this->request->get['limit'])) {
						$limit = $this->request->get['limit'];
					} else {
						$limit = 5;
					}

					$filter_data = array(
						'filter_name'	=> $filter_name,
						'filter_child'	=> 1,
						'start'			=> 0,
						'limit'			=> $limit
					);

					$results = $this->model_catalog_product->getProductsSearch($filter_data);

					foreach ($results as $result) {
						if (is_file(DIR_IMAGE . $result['image'])) {
							$image = $this->model_tool_image->resize($result['image'], 40, 40);
							$img ='<img src='.$image.' class="right circle">';
						} else {
							$image = $this->model_tool_image->resize('no_image.png', 40, 40);
							$img ='<img src='.$image.' class="right circle" width="40" height="40">';
						}
						$json[] = array(
							'product_id'	=> $result['product_id'],
							'name'			=> strip_tags(html_entity_decode($result['name'], ENT_QUOTES, 'UTF-8')),
							'img'			=> $img,
							'sku'			=> $result['sku'],
							'status'		=> $result['status']
						);
					}
				}

				$this->response->addHeader('Content-Type: application/json');
				$this->response->setOutput(json_encode($json));
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[public function index() {]]></search>
			<add position="after"><![CDATA[
			$data['product_path'] = $this->url->link('product/product');
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function getProduct($product_id) {]]></search>
			<add position="before"><![CDATA[
			public function getProductsSearch($data = array()) {
				$sql="select distinct PD.product_id as product_id, PD.name as name,P.sku as sku, P.image as image,CD.name as category, P.status as status FROM " . DB_PREFIX . "product as P LEFT JOIN " . DB_PREFIX . "product_description as PD ON(P.product_id = PD.product_id) LEFT JOIN " . DB_PREFIX . "product_to_category as PTC ON(P.product_id = PTC.product_id) Left JOIN " . DB_PREFIX . "category_description as CD ON (PTC.category_id = CD.category_id) WHERE P.status = 1 AND (PD.name LIKE '%".$data['filter_name']."%' OR P.model LIKE '%".$data['filter_name']."%' OR P.sku LIKE '%".$data['filter_name']."%' OR CD.name LIKE '%".$data['filter_name']."%') GROUP BY P.product_id";

				if (isset($data['start']) || isset($data['limit'])) {
					if ($data['start'] < 0) {
						$data['start'] = 0;
					}
					if ($data['limit'] < 1) {
						$data['limit'] = 20;
					}
					$sql .= " LIMIT " . (int)$data['start'] . "," . (int)$data['limit'];
				}
				$query = $this->db->query($sql);
				return $query->rows;
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/affiliate/tracking.php">
		<operation error="log">
			<search><![CDATA[$this->load->model('catalog/product');]]></search>
			<add position="after"><![CDATA[
			$this->load->model('tool/image');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$json[] = array(]]></search>
			<add position="before"><![CDATA[
			if (is_file(DIR_IMAGE . $result['image'])) {
				$image = $this->model_tool_image->resize($result['image'], 40, 40);
				$img ='<img src='.$image.' class="right circle">';
			} else {
				$image = $this->model_tool_image->resize('no_image.png', 40, 40);
				$img ='<img src='.$image.' class="right circle" width="40" height="40">';
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['name' => strip_tags(html_entity_decode($result['name'], ENT_QUOTES, 'UTF-8')),]]></search>
			<add position="after"><![CDATA[
			'img'	=> $img,
			]]></add>
		</operation>
	</file>
	<!-- Getting category ID -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$data['categories'][] = array(]]></search>
			<add position="after"><![CDATA[
			'id'	=> $category['category_id'],
			]]></add>
		</operation>
	</file>
	<!-- Integration of the logo module into invoices -->
	<file path="admin/model/sale/order.php">
		<operation error="log">
			<search index="0"><![CDATA[return $query->row['total'];]]></search>
			<add position="after" offset="2"><![CDATA[
			public function getProductImage($product_id) {
				$query = $this->db->query("SELECT image FROM " . DB_PREFIX . "product WHERE product_id = '" . (int)$product_id . "'");
				return $query->row;
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/controller/sale/order.php">
		<operation error="log">
			<search><![CDATA[$store_fax = $store_info['config_fax'];]]></search>
			<add position="after"><![CDATA[$store_logo = $store_info['config_logo'];]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[=> $order_info['store_name'],]]></search>
			<add position="after"><![CDATA['logo'	=> HTTP_CATALOG . 'image/' .$store_info['config_logo'],]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$option_data = array();]]></search>
			<add position="after"><![CDATA[$product['img'] = $this->model_sale_order->getProductImage($product['product_id']);]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$product_data[] = array(]]></search>
			<add position="before"><![CDATA[$this->load->model('tool/image');]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$product_data[] = array(]]></search>
			<add position="after"><![CDATA[
			'image'	=> $this->model_tool_image->resize($product['img']['image'], $this->config->get($this->config->get('config_theme') . '_image_cart_width'), $this->config->get($this->config->get('config_theme') . '_image_cart_height')),
			'width'	=> $this->config->get($this->config->get('config_theme') . '_image_cart_width'),
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/sale/order_shipping.tpl">
		<operation error="log">
			<search><![CDATA[<div style="page-break-after: always;">]]></search>
			<add position="after"><![CDATA[<img src=<?php echo $order['logo']; ?> />]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<td><b><?php echo $column_product; ?></b></td>]]></search>
			<add position="replace"><![CDATA[<td colspan="2"><b><?php echo $column_product; ?></b></td>]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<td><?php echo $product['name']; ?>]]></search>
			<add position="before"><![CDATA[<td style="width:<?php echo $product['width'] ?>px"><img src="<?php echo $product['image'] ?>"></td>]]></add>
		</operation>
	</file>
	<file path="admin/view/template/sale/order_invoice.tpl">
		<operation error="log">
			<search><![CDATA[<div style="page-break-after: always;">]]></search>
			<add position="after"><![CDATA[<img src=<?php echo $order['logo']; ?> />]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<td><b><?php echo $column_product; ?></b></td>]]></search>
			<add position="replace"><![CDATA[<td colspan="2"><b><?php echo $column_product; ?></b></td>]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<td><?php echo $product['name']; ?>]]></search>
			<add position="before"><![CDATA[<td style="width:<?php echo $product['width'] ?>px"><img src="<?php echo $product['image'] ?>"></td>]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[colspan="4"]]></search>
			<add position="replace"><![CDATA[colspan="5"]]></add>
		</operation>
	</file>
	<!-- Favicon -->
	<file path="system/library/document.php">
		<operation error="log">
			<search><![CDATA[public function addLink($href, $rel) {]]></search>
			<add position="replace"><![CDATA[
			public function addLink($href, $rel, $type='', $sizes = '') {
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['rel'  => $rel]]></search>
			<add position="replace"><![CDATA[
			'rel'	=> $rel,
			'type'	=> $type,
			'sizes'	=> $sizes
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$this->document->addLink($server . 'image/' . $this->config->get('config_icon'), 'icon');]]></search>
			<add position="replace"><![CDATA[
			$this->load->model('tool/image');

			$file = ($server . 'image/' . $this->config->get('config_icon'));
			$info = getimagesize($file);
			$icon_type = isset($info['mime']) ? $info['mime'] : '';

			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 16, 16), 'icon', $icon_type, '16x16');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 32, 32), 'icon', $icon_type, '32x32');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 48, 48), 'icon', $icon_type, '48x48');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 96, 96), 'icon', $icon_type, '96x96');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 128, 128), 'icon', $icon_type, '128x128');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 160, 160), 'icon', $icon_type, '160x160');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 196, 196), 'icon', $icon_type, '196x196');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 228, 228), 'icon', $icon_type, '228x228');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 256, 256), 'icon', $icon_type, '256x256');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 57, 57), 'apple-touch-icon', $icon_type, '57x57');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 60, 60), 'apple-touch-icon', $icon_type, '60x60');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 72, 72), 'apple-touch-icon', $icon_type, '72x72');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 76, 76), 'apple-touch-icon', $icon_type, '76x76');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 114, 114), 'apple-touch-icon', $icon_type, '114x114');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 120, 120), 'apple-touch-icon', $icon_type, '120x120');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 144, 144), 'apple-touch-icon', $icon_type, '144x144');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 152, 152), 'apple-touch-icon', $icon_type, '152x152');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 167, 167), 'apple-touch-icon', $icon_type, '167x167');
			$this->document->addLink($this->model_tool_image->resize($this->config->get('config_icon'), 180, 180), 'apple-touch-icon', $icon_type, '180x180');
			]]></add>
		</operation>
	</file>
	<!-- Subcategory chip -->
	<file path="catalog/controller/product/category.php">
		<operation error="log">
			<search><![CDATA[$data['categories'][] = array(]]></search>
			<add position="replace" offset="3"><![CDATA[
			if ($result['image']) {
				$image = $this->model_tool_image->resize($result['image'], 32, 32);
			} else {
				$image = '';
			}

			$data['categories'][] = array(
				'name'	=> $result['name'] . ($this->config->get('config_product_count') ? ' (' . $this->model_catalog_product->getTotalProducts($filter_data) . ')' : ''),
				'href'	=> $this->url->link('product/category', 'path=' . $this->request->get['path'] . '_' . $result['category_id'] . $url),
				'thumb'	=> $image
			);
			]]></add>
		</operation>
	</file>
	<!-- Other Materialize Settings -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[public function index() {]]></search>
			<add position="after"><![CDATA[
			$css = file_get_contents('catalog/view/theme/materialize/stylesheet/style.css');
			$css = preg_replace('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $css);
			$css = str_replace(': ', ':', $css);
			$css = str_replace(array("\r\n", "\r", "\n", "\t", '  ', '    ', '    '), '', $css);
			$data['css'] = $css;
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/common/footer.php">
		<operation error="log">
			<search><![CDATA[$data['contact'] = $this->url->link('information/contact');]]></search>
			<add position="before"><![CDATA[
			$data['name'] = $this->config->get('config_name');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['points'] = $product_info['points'];]]></search>
			<add position="after"><![CDATA[
			$data['lang'] = $this->language->get('code');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['points'] = $product_info['points'];]]></search>
			<add position="after"><![CDATA[
			$data['pricecurrency'] = $this->session->data['currency'];
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['rating'] = (int)$product_info['rating'];]]></search>
			<add position="after"><![CDATA[
			$data['reviewCount'] = sprintf((int)$product_info['reviews']);
			]]></add>
		</operation>
	</file>
	<!-- Getting the size of the logo -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$data['logo'] = $server . 'image/' . $this->config->get('config_logo');]]></search>
			<add position="after"><![CDATA[
			list($logo_width, $logo_height) = getimagesize($data['logo']);
			$data['logo_height'] = $logo_height;
			$data['logo_width'] = $logo_width;
			]]></add>
		</operation>
	</file>
	<!-- Common language settings Materialize -->
	<file path="catalog/controller/common/header.php">
		<operation error="skip">
			<search><![CDATA[$data['text_all'] = $this->language->get('text_all');]]></search>
			<add position="after"><![CDATA[
			$data['text_contact'] = $this->language->get('text_contact');
			$data['text_about'] = $this->language->get('text_about');
			$data['text_delivery'] = $this->language->get('text_delivery');
			$data['text_call_back'] = $this->language->get('text_call_back');
			$data['text_call_free'] = $this->language->get('text_call_free');
			]]></add>
		</operation>
		<operation error="skip">
			<search><![CDATA[$data['name'] = $this->config->get('config_name');]]></search>
			<add position="after"><![CDATA[
			$data['email'] = $this->config->get('config_email');
			$data['open'] = nl2br($this->config->get('config_open'));
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/common/footer.php">
		<operation error="skip">
			<search><![CDATA[$data['text_newsletter'] = $this->language->get('text_newsletter');]]></search>
			<add position="after"><![CDATA[
			$data['text_social_network'] = $this->language->get('text_social_network');
			]]></add>
		</operation>
		<operation error="skip">
			<search><![CDATA[$data['powered'] = sprintf($this->language->get('text_powered'), $this->config->get('config_name'), date('Y', time()));]]></search>
			<add position="after"><![CDATA[
			$data['email'] = $this->config->get('config_email');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/common/cart.php">
		<operation error="skip">
			<search><![CDATA[$data['text_loading'] = $this->language->get('text_loading');]]></search>
			<add position="after"><![CDATA[
			$data['text_shopping_cart'] = $this->language->get('text_shopping_cart');
			$data['text_cat_says'] = $this->language->get('text_cat_says');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['text_items'] = sprintf($this->language->get('text_items'), $this->cart->countProducts() + (isset($this->session->data['vouchers']) ? count($this->session->data['vouchers']) : 0), $this->currency->format($total, $this->session->data['currency']));]]></search>
			<add position="replace"><![CDATA[
			$data['text_items'] = sprintf($this->cart->countProducts() + (isset($this->session->data['vouchers']) ? count($this->session->data['vouchers']) : 0));
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/checkout/cart.php">
		<operation error="log">
			<search><![CDATA[$json['total'] = sprintf($this->language->get('text_items'), $this->cart->countProducts() + (isset($this->session->data['vouchers']) ? count($this->session->data['vouchers']) : 0), $this->currency->format($total, $this->session->data['currency']));]]></search>
			<add position="replace"><![CDATA[
			$json['total'] = sprintf($this->cart->countProducts() + (isset($this->session->data['vouchers']) ? count($this->session->data['vouchers']) : 0));
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/compare.php">
		<operation error="log">
			<search><![CDATA[$json['total'] = sprintf($this->language->get('text_compare'), (isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0));]]></search>
			<add position="replace"><![CDATA[
			$json['total'] = sprintf((isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0));
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/search.php">
		<operation error="skip">
			<search><![CDATA[$data['text_limit'] = $this->language->get('text_limit');]]></search>
			<add position="after"><![CDATA[
			$data['text_searched'] = $this->language->get('text_searched');
			$data['text_refine'] = $this->language->get('text_refine');
			$data['text_sort_short'] = $this->language->get('text_sort_short');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/category.php">
		<operation error="skip">
			<search><![CDATA[$data['text_limit'] = $this->language->get('text_limit');]]></search>
			<add position="after"><![CDATA[
			$data['text_sort_short'] = $this->language->get('text_sort_short');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="skip">
			<search><![CDATA[$data['text_loading'] = $this->language->get('text_loading');]]></search>
			<add position="after"><![CDATA[
			$data['text_category'] = $this->language->get('text_category');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_bonus_points'] = $this->language->get('text_bonus_points');
			$data['text_end_promotion'] = $this->language->get('text_end_promotion');
			$data['text_payment_method'] = $this->language->get('text_payment_method');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			// PhotoSwipe
			$data['button_share'] = $this->language->get('button_share');
			$data['button_pswp_close'] = $this->language->get('button_pswp_close');
			$data['button_pswp_toggle_fullscreen'] = $this->language->get('button_pswp_toggle_fullscreen');
			$data['button_pswp_zoom'] = $this->language->get('button_pswp_zoom');
			$data['button_pswp_prev'] = $this->language->get('button_pswp_prev');
			$data['button_pswp_next'] = $this->language->get('button_pswp_next');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/manufacturer.php">
		<operation error="skip">
			<search><![CDATA[$data['text_empty'] = $this->language->get('text_empty');]]></search>
			<add position="after"><![CDATA[
			$data['text_manufacturers_starting'] = $this->language->get('text_manufacturers_starting');
			$data['text_view_all_products'] = $this->language->get('text_view_all_products');
			$data['text_sort_short'] = $this->language->get('text_sort_short');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/special.php">
		<operation error="skip">
			<search><![CDATA[$data['text_limit'] = $this->language->get('text_limit');]]></search>
			<add position="after"><![CDATA[
			$data['text_sort_short'] = $this->language->get('text_sort_short');
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/{latest,bestseller,featured,special}*.php">
		<operation error="skip">
			<search><![CDATA[$data['text_tax'] = $this->language->get('text_tax');]]></search>
			<add position="after"><![CDATA[
			$data['text_percent'] = $this->language->get('text_percent');
			$data['text_more_detailed'] = $this->language->get('text_more_detailed');
			]]></add>
		</operation>
	</file>
	<!-- Add base64 loader -->
	<file path="catalog/controller/{common,checkout,product}/{cart,category,compare,manufacturer,product,search,special}*.php">
		<operation error="log">
			<search><![CDATA[public function index() {]]></search>
			<add position="after"><![CDATA[$data['img_loader'] = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/manufacturer.php">
		<operation error="log">
			<search><![CDATA[public function info() {]]></search>
			<add position="after"><![CDATA[$data['img_loader'] = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[public function review() {]]></search>
			<add position="after"><![CDATA[$data['img_loader'] = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/{latest,carousel,banner,bestseller,featured,special}*.php">
		<operation error="log">
			<search><![CDATA[public function index($setting) {]]></search>
			<add position="after"><![CDATA[$data['img_loader'] = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';]]></add>
		</operation>
	</file>
	<!-- Add category in product card -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$this->document->setDescription($product_info['meta_description']);]]></search>
			<add position="replace"><![CDATA[
			$this->document->setDescription($product_info['meta_description']);
			$this->load->model('catalog/category');
			$catprod = array();
			$product_category = $this->model_catalog_product->getCategories($product_id);
			foreach ($product_category as $product_cat) {
				$category_info = $this->model_catalog_category->getCategory($product_cat['category_id']);
				if ($category_info) {
					$data['category_products'][] = array(
						'name'	=> $category_info['name'],
						'href'	=> $this->url->link('product/category', 'path=' . $category_info['category_id'])
					);
				}
			}
			]]></add>
		</operation>
	</file>
	<!-- End of promotion -->
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function getProducts($data = array()) {]]></search>
			<add position="before"><![CDATA[
			public function getProductSpec($product_id) {
				$sql = $this->db->query("SELECT ps.date_end FROM " . DB_PREFIX . "product_special ps WHERE product_id = '" . (int)$product_id . "' AND ((ps.date_start = '0000-00-00' OR ps.date_start < NOW()) AND (ps.date_end = '0000-00-00' OR ps.date_end > NOW())) ORDER BY ps.priority ASC");
				if ($sql->num_rows) {
					return $sql->row['date_end'];
				} else {
					return false;
				}
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$product_info = $this->model_catalog_product->getProduct($product_id);]]></search>
			<add position="after"><![CDATA[
			$data['product_spec'] = $this->model_catalog_product->getProductSpec($product_id);
			]]></add>
		</operation>
	</file>
	<!-- Add compare -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA[$data['home'] = $this->url->link('common/home');]]></search>
			<add position="after"><![CDATA[
			$data['compare'] = $this->url->link('product/compare');
			$this->language->load('product/compare');
			$data['text_compare'] = sprintf((isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0));
			$data['text_comparison_list'] = $this->language->get('text_comparison_list');
			]]></add>
		</operation>
	</file>
	<!-- Sort by availability -->
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$sql .= " ORDER BY LCASE(" . $data['sort'] . ")";]]></search>
			<add position="replace"><![CDATA[
			$sql .= " ORDER BY (p.quantity>0) DESC, LCASE(" . $data['sort'] . ")";
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$sql .= " ORDER BY (CASE WHEN special IS NOT NULL THEN special WHEN discount IS NOT NULL THEN discount ELSE p.price END)";]]></search>
			<add position="replace"><![CDATA[
			$sql .= " ORDER BY (p.quantity>0) DESC, (CASE WHEN special IS NOT NULL THEN special WHEN discount IS NOT NULL THEN discount ELSE p.price END)";
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$sql .= " ORDER BY " . $data['sort'];]]></search>
			<add position="replace"><![CDATA[
			$sql .= " ORDER BY (p.quantity>0) DESC," . $data['sort'];
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$sql .= " ORDER BY p.sort_order";]]></search>
			<add position="replace"><![CDATA[
			$sql .= " ORDER BY (p.quantity>0) DESC, p.sort_order";
			]]></add>
		</operation>
	</file>
	<!-- Instock on category page -->
	<file path="catalog/controller/product/category.php">
		<operation error="log">
			<search><![CDATA[$data['breadcrumbs'] = array();]]></search>
			<add position="before"><![CDATA[
			if (isset($this->request->get['instock'])) {
				$instock = $this->request->get['instock'];
			} else {
				$instock = '';
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['button_cart'] = $this->language->get('button_cart');]]></search>
			<add position="before"><![CDATA[
			$data['entry_instock'] = $this->language->get('entry_instock');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$filter,]]></search>
			<add position="after"><![CDATA[
			'filter_instock'	=> $instock,
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['limit'] = $limit;]]></search>
			<add position="after"><![CDATA[
			$data['url'] = html_entity_decode($this->url->link('product/category', 'path=' . $this->request->get['path'] . $url), ENT_QUOTES, 'UTF-8');
			$data['instock'] = $instock;
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[if (!empty($data['filter_name']) || !empty($data['filter_tag'])) {]]></search>
			<add position="before"><![CDATA[
			if (!empty($data['filter_instock'])) {
				$sql .= " AND (p.stock_status_id = '7' OR p.quantity > 0)";
			}
			]]></add>
		</operation>
	</file>
	<!-- Image compression off -->
	<file path="system/library/image.php">
		<operation error="log">
			<search><![CDATA[public function save($file, $quality = 90) {]]></search>
			<add position="replace"><![CDATA[
			public function save($file) {
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[imagejpeg($this->image, $file, $quality);]]></search>
			<add position="replace"><![CDATA[
			imagejpeg($this->image, $file);
			]]></add>
		</operation>
	</file>
	<!-- Display weight in product card -->
	<file path="system/library/cart/weight.php">
		<operation error="log">
			<search><![CDATA[public function format($value, $weight_class_id, $decimal_point = '.', $thousand_point = ',') {]]></search>
			<add position="replace"><![CDATA[
			public function format($value, $weight_class_id, $decimal_point = '.', $thousand_point = '') {
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[return number_format($value, 2, $decimal_point, $thousand_point) . $this->weights[$weight_class_id]['unit'];]]></search>
			<add position="replace"><![CDATA[
			return number_format($value, 0, $decimal_point, $thousand_point) . $this->weights[$weight_class_id]['unit'];
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[return number_format($value, 2, $decimal_point, $thousand_point);]]></search>
			<add position="replace"><![CDATA[
			return number_format($value, 0, $decimal_point, $thousand_point);
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['text_tags'] = $this->language->get('text_tags');]]></search>
			<add position="after"><![CDATA[
			$data['text_weight'] = $this->language->get('text_weight');
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['points'] = $product_info['points'];]]></search>
			<add position="after"><![CDATA[
			$data['weight'] = $this->weight->format($product_info['weight'], $product_info['weight_class_id']);
			]]></add>
		</operation>
	</file>
	<!-- Add badges in category product count -->
	<file path="catalog/controller/common/header.php">
		<operation error="log">
			<search><![CDATA['name'  => $child['name'] . ($this->config->get('config_product_count') ? ' (' . $this->model_catalog_product->getTotalProducts($filter_data) . ')' : ''),]]></search>
			<add position="replace"><![CDATA[
			'name' => ($this->config->get('config_product_count') ? '<span class="new-badge" data-badge="' . $this->model_catalog_product->getTotalProducts($filter_data) . '">' . $child['name'] . '</span>' : $child['name']),
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/category.php">
		<operation error="log">
			<search><![CDATA['name' => $child['name'] . ($this->config->get('config_product_count') ? ' (' . $this->model_catalog_product->getTotalProducts($filter_data) . ')' : ''),]]></search>
			<add position="replace"><![CDATA[
			'name' => ($this->config->get('config_product_count') ? '<span class="new-badge" data-badge="' . $this->model_catalog_product->getTotalProducts($filter_data) . '">' . $child['name'] . '</span>' : $child['name']),
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['name'        => $category['name'] . ($this->config->get('config_product_count') ? ' (' . $this->model_catalog_product->getTotalProducts($filter_data) . ')' : ''),]]></search>
			<add position="replace"><![CDATA[
			'name'	=> ($this->config->get('config_product_count') ? '<span class="new-badge" data-badge="' . $this->model_catalog_product->getTotalProducts($filter_data) . '">' . $category['name'] . '</span>' : $category['name']),
			]]></add>
		</operation>
	</file>
	<!-- Related products -->
	<file path="admin/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$this->db->query("DELETE FROM " . DB_PREFIX . "product_related WHERE product_id = '" . (int)$related_id . "' AND related_id = '" . (int)$product_id . "'");]]></search>
			<add position="replace"><![CDATA[]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->db->query("INSERT INTO " . DB_PREFIX . "product_related SET product_id = '" . (int)$related_id . "', related_id = '" . (int)$product_id . "'");]]></search>
			<add position="replace"><![CDATA[]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$this->db->query("DELETE FROM " . DB_PREFIX . "product_related WHERE related_id = '" . (int)$product_id . "'");]]></search>
			<add position="replace"><![CDATA[]]></add>
		</operation>
	</file>
	<!-- Disable button cart -->
	<file path="admin/controller/catalog/product.php">
		<operation error="log">
			<search><![CDATA[if (isset($this->request->post['status'])) {]]></search>
			<add position="before"><![CDATA[
			if (isset($this->request->post['add_cart'])) {
				$data['add_cart'] = $this->request->post['add_cart'];
			} else if (!empty($product_info)) {
				$data['add_cart'] = $product_info['add_cart'];
			} else {
				$data['add_cart'] = true;
			}
			]]></add>
		</operation>
		<operation error="log">
			<search index="1"><![CDATA[$data['entry_status'] = $this->language->get('entry_status');]]></search>
			<add position="before"><![CDATA[
			$data['entry_cart'] = $this->language->get('entry_cart');
			]]></add>
		</operation>
	</file>
	<file path="admin/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[if (isset($data['image'])) {]]></search>
			<add position="before"><![CDATA[
			if (isset($data['add_cart'])) {
				$this->db->query("UPDATE " . DB_PREFIX . "product SET add_cart = '" . $this->db->escape($data['add_cart']) . "' WHERE product_id = '" . (int)$product_id . "'");
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/product_form.tpl">
		<operation error="log">
			<search><![CDATA[<label class="col-sm-2 control-label" for="input-status"><?php echo $entry_status; ?></label>]]></search>
			<add position="before" offset="1"><![CDATA[
			<div class="form-group">
				<label class="col-sm-2 control-label" for="input-cart"><?php echo $entry_cart; ?></label>
				<div class="col-sm-10">
					<select name="add_cart" id="input-cart" class="form-control">
						<?php if ($add_cart) { ?>
						<option value="1" selected="selected"><?php echo $text_enabled; ?></option>
						<option value="0"><?php echo $text_disabled; ?></option>
						<?php } else { ?>
						<option value="1"><?php echo $text_enabled; ?></option>
						<option value="0" selected="selected"><?php echo $text_disabled; ?></option>
						<?php } ?>
					</select>
				</div>
			</div>
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/{product,manufacturer,special,category,search}*.php">
		<operation error="log">
			<search><![CDATA['product_id'  => $result['product_id'],]]></search>
			<add position="before"><![CDATA[
			'add_cart'	=> (int)$result['add_cart'],
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['rating'] = (int)$product_info['rating'];]]></search>
			<add position="before"><![CDATA[
			$data['add_cart'] = (int)$product_info['add_cart'];
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/compare.php">
		<operation error="log">
			<search><![CDATA['product_id'   => $product_info['product_id'],]]></search>
			<add position="before"><![CDATA[
			'add_cart'	=> (int)$product_info['add_cart'],
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/account/wishlist.php">
		<operation error="log">
			<search><![CDATA['product_id' => $product_info['product_id'],]]></search>
			<add position="before"><![CDATA[
			'add_cart'	=> (int)$product_info['add_cart'],
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/{latest,special,bestseller}*.php">
		<operation error="log">
			<search><![CDATA['product_id'  => $result['product_id'],]]></search>
			<add position="before"><![CDATA[
			'add_cart'	=> (int)$result['add_cart'],
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/featured.php">
		<operation error="log">
			<search><![CDATA['product_id'  => $product_info['product_id'],]]></search>
			<add position="before"><![CDATA[
			'add_cart'	=> (int)$product_info['add_cart'],
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA['viewed'           => $query->row['viewed']]]></search>
			<add position="replace"><![CDATA[
			'viewed'	=> $query->row['viewed'],
			'add_cart'	=> $query->row['add_cart']
			]]></add>
		</operation>
	</file>
	<!-- Displays the discount percentage -->
	<file path="catalog/controller/product/{product,manufacturer,search,category,special}*.php">
		<operation error="log">
			<search><![CDATA[$special = $this->currency->format($this->tax->calculate($result['special'], $result['tax_class_id'], $this->config->get('config_tax')), $this->session->data['currency']);]]></search>
			<add position="after"><![CDATA[
			$percent_discount = round(100-($result['special']/($result['price']/100)));
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$special = false;]]></search>
			<add position="after"><![CDATA[
			$percent_discount = false;
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['special'     => $special,]]></search>
			<add position="after"><![CDATA[
			'percent_discount' => $percent_discount,
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/featured.php">
		<operation error="log">
			<search><![CDATA[$special = $this->currency->format($this->tax->calculate($product_info['special'], $product_info['tax_class_id'], $this->config->get('config_tax')), $this->session->data['currency']);]]></search>
			<add position="after"><![CDATA[
			$percent_discount = round(100-($product_info['special']/($product_info['price']/100)));
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$special = false;]]></search>
			<add position="after"><![CDATA[
			$percent_discount = false;
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['special'     => $special,]]></search>
			<add position="after"><![CDATA[
			'percent_discount' => $percent_discount,
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/extension/module/{bestseller,latest,special}.php">
		<operation error="log">
			<search><![CDATA[$special = $this->currency->format($this->tax->calculate($result['special'], $result['tax_class_id'], $this->config->get('config_tax')), $this->session->data['currency']);]]></search>
			<add position="after"><![CDATA[
			$percent_discount = round(100-($result['special']/($result['price']/100)));
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$special = false;]]></search>
			<add position="after"><![CDATA[
			$percent_discount = false;
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA['special'     => $special,]]></search>
			<add position="after"><![CDATA[
			'percent_discount' => $percent_discount,
			]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['special'] = $this->currency->format($this->tax->calculate($product_info['special'], $product_info['tax_class_id'], $this->config->get('config_tax')), $this->session->data['currency']);]]></search>
			<add position="after"><![CDATA[
			$data['percent_discount'] = round(100-($product_info['special']/($product_info['price']/100)));
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['special'] = false;]]></search>
			<add position="after"><![CDATA[
			$data['percent_discount'] = false;
			]]></add>
		</operation>
	</file>
	<!-- Adding the manufacturer's logo on the product card -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$this->load->model('tool/image');]]></search>
			<add position="after"><![CDATA[
			$manufacturer_image = $this->model_catalog_manufacturer->getManufacturer($product_info['manufacturer_id']);
			if($manufacturer_image) {
				$data['manufacturers_img'] = $this->model_tool_image->resize($manufacturer_image['image'], 100, 100);
				$data['img_loader'] = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';
			} else {
				$data['manufacturers_img'] = false;
			}
			]]>
			</add>
		</operation>
	</file>
	<!-- Adding the manufacturer's logo on the manufacturer's list -->
	<file path="catalog/controller/product/manufacturer.php">
		<operation error="log">
			<search><![CDATA['href' => $this->url->link('product/manufacturer/info', 'manufacturer_id=' . $result['manufacturer_id'])]]></search>
			<add position="before"><![CDATA[
			'logo' => $this->model_tool_image->resize($result['image'], 100, 100),
			]]>
			</add>
		</operation>
	</file>
	<!-- Stock Statuses -->
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA['stock_status'     => $query->row['stock_status'],]]></search>
			<add position="after"><![CDATA[
			'stock_status_id'	=> $query->row['stock_status_id'],
			]]>
			</add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['points'] = $product_info['points'];]]></search>
			<add position="after"><![CDATA[
			$data['stock_status_id'] = $product_info['stock_status_id'];
			]]>
			</add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['stock'] = $product_info['quantity'];]]></search>
			<add position="after"><![CDATA[
			$data['stock_color'] = "green";
			$data['stock_status'] = "http://schema.org/InStock";
			]]>
			</add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['stock'] = $this->language->get('text_instock');]]></search>
			<add position="after"><![CDATA[
			$data['stock_color'] = "green";
			$data['stock_status'] = "http://schema.org/InStock";
			]]>
			</add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['stock'] = $product_info['stock_status'];]]></search>
			<add position="after"><![CDATA[
			if($data['stock_status_id'] == 5) {
				$data['stock_color'] = "red";
				$data['stock_status'] = "http://schema.org/OutOfStock";
			} elseif ($data['stock_status_id'] == 8) {
				$data['stock_color'] = "orange";
				$data['stock_status'] = "http://schema.org/PreOrder";
			} elseif ($data['stock_status_id'] == 6) {
				$data['stock_color'] = "lime";
				$data['stock_status'] = "http://schema.org/OutOfStock";
			} elseif ($data['stock_status_id'] == 7) {
				$data['stock_color'] = "green";
				$data['stock_status'] = "http://schema.org/InStock";
			} else {
				$data['stock_color'] = "grey";
				$data['stock_status'] = "";
			}
			]]>
			</add>
		</operation>
	</file>
	<!-- Slider images on the product card -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['popup'] = $this->model_tool_image->resize($product_info['image'], $this->config->get($this->config->get('config_theme') . '_image_popup_width'), $this->config->get($this->config->get('config_theme') . '_image_popup_height'));]]></search>
			<add position="after"><![CDATA[
			$data['popup_size'] = $this->config->get($this->config->get('config_theme') . '_image_popup_width').'x'.$this->config->get($this->config->get('config_theme') . '_image_popup_height');
			]]>
			</add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['images'] = array();]]></search>
			<add position="before"><![CDATA[
			if ($product_info['image']) {
				$data['thumb_small'] = $this->model_tool_image->resize($product_info['image'], $this->config->get($this->config->get('config_theme') . '_image_additional_width'), $this->config->get($this->config->get('config_theme') . '_image_additional_height'));
			} else {
				$data['thumb_small'] = '';
			}
			]]>
			</add>
		</operation>
		<operation error="log">
			<search><![CDATA['popup' => $this->model_tool_image->resize($result['image'], $this->config->get($this->config->get('config_theme') . '_image_popup_width'), $this->config->get($this->config->get('config_theme') . '_image_popup_height')),]]></search>
			<add position="before"><![CDATA[
			'thumb_array' => $this->model_tool_image->resize($result['image'], $this->config->get($this->config->get('config_theme') . '_image_thumb_width'), $this->config->get($this->config->get('config_theme') . '_image_thumb_height')),
			]]>
			</add>
		</operation>
	</file>
	<!-- Custom Tab -->
	<file path="catalog/controller/product/product.php">
		<operation error="log">
			<search><![CDATA[$data['images'] = array();]]></search>
			<add position="before"><![CDATA[
			$data['customtabs'] = array();
			$results = $this->model_catalog_product->getProducttabs($this->request->get['product_id']);
			foreach ($results as $result) {
				$data['customtabs'][] = array(
					'title'			=> $result['title'],
					'description'	=> html_entity_decode($result['description'], ENT_QUOTES, 'UTF-8'),
				);
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/controller/catalog/product.php">
		<operation error="log">
			<search><![CDATA[if (isset($this->request->post['image'])) {]]></search>
			<add position="before"><![CDATA[
			$data['tab_customtab']=$this->language->get('tab_customtab');
			$data['entry_title']=$this->language->get('entry_title');
			$data['entry_description']=$this->language->get('entry_description');
			$data['button_customtab_add']=$this->language->get('button_customtab_add');
			$data['text_apply']=$this->language->get('text_apply');

			if (isset($this->request->post['product_customtab'])) {
				$data['product_customtabs'] = $this->request->post['product_customtab'];
			} elseif (isset($this->request->get['product_id'])) {
				$data['product_customtabs'] = $this->model_catalog_product->getProductcustomtabs($this->request->get['product_id']);
			} else {
				$data['product_customtabs'] = array();
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[$product_id = $this->db->getLastId();]]></search>
			<add position="after"><![CDATA[
			if (isset($data['product_customtab'])) {
				foreach ($data['product_customtab'] as $product_customtab) {
					$this->db->query("INSERT INTO " . DB_PREFIX . "product_customtab SET product_id = '" . (int)$product_id . "', sort_order = '" . (int)$product_customtab['sort_order'] . "', status = '" . (int)$product_customtab['status'] . "'");

					$product_customtab_id = $this->db->getLastId();

					foreach ($product_customtab['product_customtab_description'] as $language_id => $product_customtab_description) {
						$this->db->query("INSERT INTO " . DB_PREFIX . "product_customtab_description SET product_customtab_id = '" . (int)$product_customtab_id . "', language_id = '" . (int)$language_id . "', product_id = '" . (int)$product_id . "', title = '" .  $this->db->escape($product_customtab_description['title']) . "', description = '" . $this->db->escape($product_customtab_description['description']) . "'");
					}
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[date_modified = NOW() WHERE product_id = '" . (int)$product_id . "'");]]></search>
			<add position="after"><![CDATA[
			$this->db->query("DELETE FROM " . DB_PREFIX . "product_customtab WHERE product_id = '" . (int)$product_id . "'");
			$this->db->query("DELETE FROM " . DB_PREFIX . "product_customtab_description WHERE product_id = '" . (int)$product_id . "'");
			if (isset($data['product_customtab'])) {
				foreach ($data['product_customtab'] as $product_customtab) {
					$this->db->query("INSERT INTO " . DB_PREFIX . "product_customtab SET product_id = '" . (int)$product_id . "', sort_order = '" . (int)$product_customtab['sort_order'] . "', status = '" . (int)$product_customtab['status'] . "'");

					$product_customtab_id = $this->db->getLastId();

					foreach ($product_customtab['product_customtab_description'] as $language_id => $product_customtab_description) {
						$this->db->query("INSERT INTO " . DB_PREFIX . "product_customtab_description SET product_customtab_id = '" . (int)$product_customtab_id . "', language_id = '" . (int)$language_id . "', product_id = '" . (int)$product_id . "', title = '" . $this->db->escape($product_customtab_description['title']) . "', description = '" .  $this->db->escape($product_customtab_description['description']) . "'");
					}
				}
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[public function getProductImages($product_id) {]]></search>
			<add position="before"><![CDATA[
			public function getProductcustomtabs($product_id) {
				$product_customtab_data = array();
				$product_customtab_query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_customtab WHERE product_id = '" . (int)$product_id . "' ORDER BY sort_order ASC");
				foreach ($product_customtab_query->rows as $product_customtab) {
					$product_customtab_description_data = array();
					$product_customtab_description_query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_customtab_description WHERE product_customtab_id = '" . (int)$product_customtab['product_customtab_id'] . "' AND product_id = '" . (int)$product_id . "'");

					foreach ($product_customtab_description_query->rows as $product_customtab_description) {
						$product_customtab_description_data[$product_customtab_description['language_id']] = array(
							'title'			=> $product_customtab_description['title'],
							'description'	=> $product_customtab_description['description'],
						);
					}

					$product_customtab_data[] = array(
						'product_customtab_description' => $product_customtab_description_data,
						'status'		=> $product_customtab['status'],
						'sort_order'	=> $product_customtab['sort_order']
					);
				}
				return $product_customtab_data;
			}
			]]></add>
		</operation>
	</file>
	<file path="catalog/model/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function getProductImages($product_id) {]]></search>
			<add position="before"><![CDATA[
			public function getProducttabs($product_id) {
				$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_customtab pc LEFT JOIN " . DB_PREFIX . "product_customtab_description pcd ON (pc.product_customtab_id  = pcd.product_customtab_id) WHERE pc.product_id = '" . (int)$product_id . "'  AND pcd.language_id = '" . (int)$this->config->get('config_language_id') . "' AND status > 0 ORDER BY sort_order ASC");

				return $query->rows;
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/product_form.tpl">
		<operation error="log">
			<search><![CDATA[<li><a href="#tab-design" data-toggle="tab"><?php echo $tab_design; ?></a></li>]]></search>
			<add position="after"><![CDATA[
				<li><a href="#tab-customtabmain" data-toggle="tab"><?php echo $tab_customtab; ?></a></li>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<div class="tab-pane" id="tab-design">]]></search>
			<add position="before"><![CDATA[
			<div class="tab-pane" id="tab-customtabmain">
				<div class="col-sm-2">
					<ul class="nav nav-pills nav-stacked" id="customtab">
						<?php $customtab_row = 0; ?>
						<?php foreach ($product_customtabs as $product_customtab) { ?>
						<li><a href="#tab-customtab<?php echo $customtab_row; ?>" data-toggle="tab"><i class="fa fa-minus-circle" onclick="$('a[href=\'#tab-customtab<?php echo $customtab_row; ?>\']').parent().remove(); $('#tab-customtab<?php echo $customtab_row; ?>').remove(); $('#customtab a:first').tab('show');"></i> <?php echo $tab_customtab . ' ' . $customtab_row; ?></a></li>
						<?php $customtab_row++; ?>
						<?php } ?>
						<li id="customtab-add"><a onclick="addCustomtab();"><i class="fa fa-plus-circle"></i> <?php echo $button_customtab_add; ?></a></li>
					</ul>
				</div>
			<div class="col-sm-10">
				<div class="tab-content tab-content2">
					<?php $customtab_row = 0; ?>
					<?php foreach ($product_customtabs as $product_customtab) { ?>
					<div class="tab-pane" id="tab-customtab<?php echo $customtab_row; ?>">
						<ul class="nav nav-tabs" id="clanguage<?php echo $customtab_row; ?>">
							<?php foreach ($languages as $language) { ?>
							<li><a href="#tab-customtab<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>" data-toggle="tab"><img src="language/<?php echo $language['code']; ?>/<?php echo $language['code']; ?>.png" title="<?php echo $language['name']; ?>" />  <?php echo $language['name']; ?></a></li>
							<?php } ?>
						</ul>
						<div class="tab-content">
							<?php foreach ($languages as $language) { ?>
							<div class="tab-pane" id="tab-customtab<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>">
								<div class="form-group">
									<label class="col-sm-2 control-label" for="input-heading<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>"><?php echo $entry_title; ?></label>
									<div class="col-sm-10">
										<input type="text" name="product_customtab[<?php echo $customtab_row; ?>][product_customtab_description][<?php echo $language['language_id']; ?>][title]" value="<?php echo isset($product_customtab['product_customtab_description'][$language['language_id']]) ? $product_customtab['product_customtab_description'][$language['language_id']]['title'] : ''; ?>" class="form-control"/>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-2 control-label" for="input-description<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>"><?php echo $entry_description; ?></label>
									<div class="col-sm-10">
										<textarea name="product_customtab[<?php echo $customtab_row; ?>][product_customtab_description][<?php echo $language['language_id']; ?>][description]" placeholder="<?php echo $entry_description; ?>" id="input-description<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>" class="form-control"><?php echo isset($product_customtab['product_customtab_description'][$language['language_id']]) ? $product_customtab['product_customtab_description'][$language['language_id']]['description'] : ''; ?></textarea>
									</div>
								</div>
							</div>
							<?php } ?>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label" for="input-sort_order<?php echo $customtab_row; ?>"><?php echo $entry_sort_order; ?></label>
							<div class="col-sm-10">
								<input type="text" name="product_customtab[<?php echo $customtab_row; ?>][sort_order]" value="<?php echo $product_customtab['sort_order']; ?>" placeholder="<?php echo $entry_sort_order; ?>" class="form-control" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label" for="input-status<?php echo $customtab_row; ?>"><?php echo $entry_status; ?></label>
							<div class="col-sm-10">
								<select name="product_customtab[<?php echo $customtab_row; ?>][status]" id="input-status" class="form-control">
									<?php if ($product_customtab['status']) { ?>
									<option value="1" selected="selected"><?php echo $text_enabled; ?></option>
									<option value="0"><?php echo $text_disabled; ?></option>
									<?php } else { ?>
									<option value="1"><?php echo $text_enabled; ?></option>
									<option value="0" selected="selected"><?php echo $text_disabled; ?></option>
									<?php } ?>
								</select>
							</div>
						</div>
					</div>
					<?php $customtab_row++; ?>
					<?php } ?>
					</div>
				</div>
			</div>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<?php echo $footer; ?>]]></search>
			<add position="before"><![CDATA[
			<script type="text/javascript"><!--
				<?php $customtab_row = 0; ?>
				<?php foreach ($product_customtabs as $product_customtab) { ?>
				<?php foreach ($languages as $language) { ?>
				$('#input-description<?php echo $customtab_row; ?>-language<?php echo $language['language_id']; ?>').summernote({
					height: 300
				});
				<?php } ?>
				<?php $customtab_row++; ?>
				<?php } ?>
			//--></script>
			<script type="text/javascript"><!--
				var customtab_row = <?php echo $customtab_row; ?>;
				function addCustomtab() {
					html = '<div id="tab-customtab' + customtab_row + '" class="tab-pane">';
					html += '	<ul class="nav nav-tabs" id="clanguage' + customtab_row + '">';
					<?php foreach ($languages as $language) { ?>
					html += '		<li><a href="#tab-customtab' + customtab_row + '-language<?php echo $language['language_id']; ?>" data-toggle="tab"><img src="language/<?php echo $language['code']; ?>/<?php echo $language['code']; ?>.png" title="<?php echo $language['name']; ?>" /> <?php echo $language['name']; ?></a></li>';
					<?php } ?>
					html += '	</ul>';
					html += '	<div class="tab-content">';
					<?php foreach ($languages as $language) { ?>
					html += '		<div class="tab-pane" id="tab-customtab' + customtab_row + '-language<?php echo $language['language_id']; ?>">';
					html += '			<div class="form-group">';
					html += '				<label class="col-sm-2 control-label" for="input-title' + customtab_row + '-language<?php echo $language['language_id']; ?>"><?php echo $entry_title; ?></label>';
					html += '				<div class="col-sm-10"><input type="text" name="product_customtab[' + customtab_row + '][product_customtab_description][<?php echo $language['language_id']; ?>][title]" placeholder="<?php echo $entry_title; ?>" id="input-title' + customtab_row + '-language<?php echo $language['language_id']; ?>" value="" class="form-control"/></div>';
					html += '			</div>';
					html += '			<div class="form-group">';
					html += '				<label class="col-sm-2 control-label" for="input-description' + customtab_row + '-language<?php echo $language['language_id']; ?>"><?php echo $entry_description; ?></label>';
					html += '				<div class="col-sm-10"><textarea name="product_customtab[' + customtab_row + '][product_customtab_description][<?php echo $language['language_id']; ?>][description]" id="input-description' + customtab_row + '-language<?php echo $language['language_id']; ?>"></textarea></div>';
					html += '			</div>';
					html += '		</div>';
					<?php } ?>
					html += '	</div>';
					html += '	<div class="form-group">';
					html += '		<label class="col-sm-2 control-label" for="input-status' + customtab_row +'"><?php echo $entry_status; ?></label>';
					html += '		<div class="col-sm-10"><select name="product_customtab[' + customtab_row + '][status]" class="form-control"><option value="1"><?php echo $text_enabled; ?></option><option value="0"><?php echo $text_disabled; ?></option></select></div>';
					html += '	</div>';
					html += '	<div class="form-group">';
					html += '		<label class="col-sm-2 control-label" for="input-sort_order' + customtab_row +'"><?php echo $entry_sort_order; ?></label>';
					html += '		<div class="col-sm-10"><input type="text" name="product_customtab[' + customtab_row + '][sort_order]" value="" class="form-control" /></div>';
					html += '	</div>';
					html += '</div>';
					$('#tab-customtabmain .tab-content2').append(html);
					<?php foreach ($languages as $language) { ?>
					$('#input-description' + customtab_row + '-language<?php echo $language['language_id']; ?>').summernote({
						height: 300
					});
				<?php } ?>
				$('#customtab a[href=\'#tab-customtab' + customtab_row + '\']').tab('show');
				$('#clanguage' + customtab_row + ' li:first-child a').tab('show');
				$('#customtab-add').before('<li><a href="#tab-customtab' + customtab_row + '" data-toggle="tab"><i class="fa fa-minus-circle" onclick="$(\'a[href=\\\'#tab-customtab' + customtab_row + '\\\']\').parent().remove(); $(\'#tab-customtab' + customtab_row + '\').remove(); $(\'#customtab li a:first\').tab(\'show\');"></i> <?php echo $tab_customtab; ?> ' + customtab_row + '</a></li>');
				$('#customtab-' + customtab_row).trigger('click');
				customtab_row++;
				}
			//--></script>
			<script type="text/javascript"><!--
				$('#customtab li:first-child a').tab('show');
				<?php $customtab_row = 0; ?>
				<?php foreach ($product_customtabs as $product_customtab) { ?>
				$('#clanguage<?php echo $customtab_row; ?> li:first-child a').tab('show');
				<?php $customtab_row++; ?>
				<?php } ?>
			//--></script>
			]]></add>
		</operation>
	</file>
	<!-- Apply button -->
	<file path="admin/controller/catalog/product.php">
		<operation error="log">
			<search><![CDATA[public function autocomplete()]]></search>
			<add position="before"><![CDATA[
			public function updateStay() {
				$this->load->language('catalog/product');
				$this->document->setTitle($this->language->get('heading_title'));
				$this->load->model('catalog/product');
			if (($this->request->server['REQUEST_METHOD'] == 'POST') && $this->validateForm()) {
				$this->model_catalog_product->editProduct($this->request->get['product_id'], $this->request->post);
				$this->session->data['success'] = $this->language->get('text_success');
				$url = '';
			if (isset($this->request->get['product_id'])) {
				$url .= '&product_id=' . $this->request->get['product_id'];
			}
				$this->response->redirect($this->url->link('catalog/product/edit', 'token=' . $this->session->data['token'] . $url, true));
			}
				$this->getForm();
			}
			]]></add>
		</operation>
		<operation error="log">
			<search index="0"><![CDATA[$data['action']]]></search>
			<add position="after"><![CDATA[
			$data['action_stay'] = $this->url->link('catalog/product/add', 'token=' . $this->session->data['token'] . $url, true);
			]]></add>
		</operation>
		<operation error="log">
			<search index="1"><![CDATA[$data['action']]]></search>
			<add position="after"><![CDATA[
			$data['action_stay'] = $this->url->link('catalog/product/updateStay', 'token=' . $this->session->data['token'] . '&product_id=' . $this->request->get['product_id'] . $url, true);
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[catalog/product_form]]></search>
			<add position="before"><![CDATA[
			if (isset($this->session->data['success'])) {
				$data['success'] = $this->session->data['success'];
				unset($this->session->data['success']);
			} else {
				$data['success'] = '';
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/product_form.tpl">
		<operation error="log">
			<search><![CDATA[<div class="panel panel-default">]]></search>
			<add position="before"><![CDATA[
			<?php if ($success) { ?>
			<div class="alert alert-success"><i class="fa fa-check-circle"></i> <?php echo $success; ?>
				<button type="button" class="close" data-dismiss="alert">&times;</button>
			</div>
			<?php } ?>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<ul class="nav nav-tabs">]]></search>
			<add position="replace"><![CDATA[
			<ul class="nav nav-tabs" id="myTab">
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<div class="pull-right">]]></search>
			<add position="after"><![CDATA[
			<button type="button" onclick="SaS();" type="button" form="form-product" data-toggle="tooltip" title="<?php echo $text_apply; ?>" class="btn btn-success"><i class="fa fa-repeat"></i></button>
			]]>
			</add>
		</operation>
		<operation error="log">
		<search><![CDATA[<?php echo $footer; ?>]]></search>
			<add position="before"><![CDATA[
			<script type="text/javascript"><!--
				$(document).ready(function() {
				if (sessionStorage['index_p']) {
					var index_p = sessionStorage['index_p'];
				} else {
					var index_p = 0;
				}
				$('#myTab li:eq(' + index_p + ') a').tab('show');
					sessionStorage['index_p'] = 0;
				});
				function SaS() {
				sessionStorage['index_p'] = $(".nav-tabs .active").index();
				$('#form-product').attr('action', '<?php echo (htmlspecialchars_decode($action_stay)); ?>');
				$('#form-product').submit();
					e.preventDefault();
				};
			//--></script>
			<script>
			document.addEventListener("keydown", function(event) {
				if (event.keyCode == 83 && (navigator.platform.match("Mac") ? event.metaKey : event.ctrlKey)) {
					event.preventDefault();
					var applyBtn = $('#apply-btn');
					applyBtn.trigger('click');
				}
			}, false);
			</script>
			]]></add>
		</operation>
	</file>
	<file path="admin/controller/catalog/category.php">
		<operation error="log">
			<search><![CDATA[public function autocomplete()]]></search>
			<add position="before"><![CDATA[
			public function updateStay() {
				$this->load->language('catalog/category');
				$this->document->setTitle($this->language->get('heading_title'));
				$this->load->model('catalog/category');
			if (($this->request->server['REQUEST_METHOD'] == 'POST') && $this->validateForm()) {
				$this->model_catalog_category->editCategory($this->request->get['category_id'], $this->request->post);
				$this->session->data['success'] = $this->language->get('text_success');
				$url = '';
			if (isset($this->request->get['category_id'])) {
				$url .= '&category_id=' . $this->request->get['category_id'];
			}
				$this->response->redirect($this->url->link('catalog/category/edit', 'token=' . $this->session->data['token'] . $url, true));
			}
				$this->getForm();
			}
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[$data['heading_title'] = $this->language->get('heading_title');]]></search>
			<add position="before"><![CDATA[
			$data['text_apply'] = $this->language->get('text_apply');
			]]></add>
		</operation>
		<operation error="log">
			<search index="0"><![CDATA[$data['action']]]></search>
			<add position="after"><![CDATA[
			$data['action_stay'] = $this->url->link('catalog/category/add', 'token=' . $this->session->data['token'] . $url, true);
			]]></add>
		</operation>
		<operation error="log">
			<search index="1"><![CDATA[$data['action']]]></search>
			<add position="after"><![CDATA[
			$data['action_stay'] = $this->url->link('catalog/category/updateStay', 'token=' . $this->session->data['token'] . '&category_id=' . $this->request->get['category_id'] . $url, true);
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[catalog/category_form]]></search>
			<add position="before"><![CDATA[
			if (isset($this->session->data['success'])) {
				$data['success'] = $this->session->data['success'];
				unset($this->session->data['success']);
			} else {
				$data['success'] = '';
			}
			]]></add>
		</operation>
	</file>
	<file path="admin/view/template/catalog/category_form.tpl">
		<operation error="log">
			<search><![CDATA[<div class="panel panel-default">]]></search>
			<add position="before"><![CDATA[
			<?php if ($success) { ?>
			<div class="alert alert-success"><i class="fa fa-check-circle"></i> <?php echo $success; ?>
				<button type="button" class="close" data-dismiss="alert">&times;</button>
			</div>
			<?php } ?>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<ul class="nav nav-tabs">]]></search>
			<add position="replace"><![CDATA[
			<ul class="nav nav-tabs" id="myTab">
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<div class="pull-right">]]></search>
			<add position="after"><![CDATA[
			<button type="button" onclick="SaS();" type="button" form="form-category" data-toggle="tooltip" title="<?php echo $text_apply; ?>" class="btn btn-success"><i class="fa fa-repeat"></i></button>
			]]></add>
		</operation>
		<operation error="log">
			<search><![CDATA[<?php echo $footer; ?>]]></search>
			<add position="before"><![CDATA[
			<script type="text/javascript"><!--
			$(document).ready(function() {
			if (sessionStorage['index_p']) {
				var index_p = sessionStorage['index_p'];
			} else {
				var index_p = 0;
			}
			$('#myTab li:eq(' + index_p + ') a').tab('show');
				sessionStorage['index_p'] = 0;
			});
			function SaS() {
				sessionStorage['index_p'] = $(".nav-tabs .active").index();
				$('#form-category').attr('action', '<?php echo (htmlspecialchars_decode($action_stay)); ?>');
				$('#form-category').submit();
				e.preventDefault();
			};
			//--></script>
			<script>
			document.addEventListener("keydown", function(event) {
				if (event.keyCode == 83 && (navigator.platform.match("Mac") ? event.metaKey : event.ctrlKey)) {
					event.preventDefault();
					var applyBtn = $('#apply-btn');
					applyBtn.trigger('click');
				}
			}, false);
			</script>
			]]></add>
		</operation>
	</file>
</modification>